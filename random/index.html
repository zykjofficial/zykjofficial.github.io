<!DOCTYPE html><html lang="zh-cn"><head><meta charset="UTF-8"><link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/zykjofficial/zykjofficial.github.io@master/img/favicon.ico"><title>幸运儿选择</title><link rel="stylesheet" href="./css/style.css"><style></style></head><body><div id="web_bg"></div><div class="login-info"><input type="file" id="file" style="display:none" accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"> <span id="result" style="font-size:1.5rem;font-weight:700">选一位同学</span><form method="post" action="LoginServlet"><div class="switch"><span id="login" class="active">选</span> <span>/</span> <span id="signup">择</span></div><div class="check"><div class="input username" placeholder="表 (默认为1)"><input type="number" name="sheet" min="1" autocomplete="off"></div><div class="input password" placeholder="列 (默认为2)"><input type="password" name="row" autocomplete="off"></div><div class="input rightpassword" placeholder="列名 (默认为姓名)"><input type="password" name="row_name" autocomplete="off"></div></div><div class="btn"><input type="button" onclick="selectFile()" value="抽取本次幸运儿"></div></form></div><script src="./js/jquery.min.js"></script><script src="./js/xlsx.core.min.js"></script><script>function selectFile(){document.getElementById("file").click()}function readWorkbookFromLocalFile(e,t){var n=new FileReader;n.onload=function(e){var n=e.target.result,o=XLSX.read(n,{type:"binary"});t&&t(o)},n.readAsBinaryString(e)}function outputWorkbook(e){e.SheetNames.forEach(t=>{var n=e.Sheets[t];for(var o in n)console.log(o,"!"===o[0]?n[o]:n[o].v)})}function readWorkbook(e){var t=e.SheetNames,n=document.getElementsByName("sheet")[0].value?document.getElementsByName("sheet")[0].value-1:0,o=e.Sheets[t[n]],a=document.getElementsByName("row_name")[0].value?document.getElementsByName("row_name")[0].value:"姓名";document.getElementsByName("row")[0].value&&document.getElementsByName("row")[0].value;console.log(o);var i=XLSX.utils.sheet_to_json(o),l=i.length-1,r=Math.floor(Math.random()*l);console.log(l,r,n),console.log(i[r][a]),document.getElementById("result").innerHTML="恭喜这位同学："+i[r][a]}$((function(){document.getElementById("file").addEventListener("change",(function(e){var t=e.target.files;if(0!=t.length){var n=t[0];/\.xlsx$/g.test(n.name)?readWorkbookFromLocalFile(n,(function(e){readWorkbook(e)})):alert("仅支持读取xlsx格式！")}}))}));var login=document.querySelector("#login"),signup=document.querySelector("#signup"),active=null,editinput=document.querySelectorAll(".check input"),submit=document.querySelector(" .btn input"),form=document.querySelector(".login-info form");login.addEventListener("click",(function(){active=document.querySelectorAll(".active");for(var e=0;e<active.length;e++)active[e].className="";this.className="active";for(e=0;e<editinput.length;e++)editinput[e].value="",editinput[e].parentNode.className=editinput[e].parentNode.className.replace("focus","").trim()})),signup.addEventListener("click",(function(){active=document.querySelectorAll(".active");for(var e=0;e<active.length;e++)active[e].className="";this.className="active";for(e=0;e<editinput.length;e++)editinput[e].value="",editinput[e].parentNode.className=editinput[e].parentNode.className.replace("focus","").trim()}));for(var i=0;i<editinput.length;i++)editinput[i].addEventListener("focus",(function(){var e=this.parentNode.className.trim();this.parentNode.className=e+" focus"})),editinput[i].addEventListener("blur",(function(){""==this.value.trim()&&(this.parentNode.className=this.parentNode.className.replace("focus","").trim())}))</script></body></html>