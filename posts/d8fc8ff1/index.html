<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><title>Nodejs学习 | ZYKJ's Blog</title><meta name="keywords" content="Nodejs"><meta name="author" content="ZYKJ"><meta name="copyright" content="ZYKJ"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="Node.js 是一个基于 Chrome V8 引擎的 JavaScript 运行环境。 Node.js 使用了一个事件驱动、非阻塞式 I&#x2F;O 的模型。"><meta property="og:type" content="article"><meta property="og:title" content="Nodejs学习"><meta property="og:url" content="https://zykj.js.org/posts/d8fc8ff1/index.html"><meta property="og:site_name" content="ZYKJ&#39;s Blog"><meta property="og:description" content="Node.js 是一个基于 Chrome V8 引擎的 JavaScript 运行环境。 Node.js 使用了一个事件驱动、非阻塞式 I&#x2F;O 的模型。"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://gcore.jsdelivr.net/gh/zykjofficial/zykjimg/img/nodejsstudy-cover.png"><meta property="article:published_time" content="2020-07-06T02:53:26.000Z"><meta property="article:modified_time" content="2020-07-06T02:53:26.000Z"><meta property="article:author" content="ZYKJ"><meta property="article:tag" content="前端"><meta property="article:tag" content="Nodejs"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://gcore.jsdelivr.net/gh/zykjofficial/zykjimg/img/nodejsstudy-cover.png"><link rel="shortcut icon" href="https://gcore.jsdelivr.net/gh/zykjofficial/zykjofficial.github.io@master/img/favicon.ico"><link rel="canonical" href="https://zykj.js.org/posts/d8fc8ff1/"><link rel="preconnect" href="//gcore.jsdelivr.net"><link rel="manifest" href="/img/pwa/manifest.json"><link rel="apple-touch-icon" sizes="180x180" href="/img/pwa/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/img/pwa/32.png"><link rel="icon" type="image/png" sizes="16x16" href="/img/pwa/16.png"><link rel="mask-icon" href="/img/pwa/safari-pinned-tab.svg" color="#5bbad5"><link rel="stylesheet" href="https://gcore.jsdelivr.net/gh/zykjofficial/zykjofficial.github.io@master/css/index.css"><link rel="stylesheet" href="https://gcore.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://gcore.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://gcore.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload='this.media="all"'><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:{path:"/search.xml",preload:!1,languages:{hits_empty:"找不到您查询的内容：${query}"}},translate:void 0,noticeOutdate:{limitDay:30,position:"top",messagePrev:"这篇文章已经发表了",messageNext:"天了，其中部分内容可能已经过时。"},highlight:{plugin:"highlighjs",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:!1},copy:{success:"复制成功",error:"复制错误",noSupport:"浏览器不支持"},relativeDate:{homepage:!1,post:!1},runtime:"天",date_suffix:{just:"刚刚",min:"分钟前",hour:"小时前",day:"天前",month:"个月前"},copyright:void 0,lightbox:"fancybox",Snackbar:{chs_to_cht:"你已切换为繁体",cht_to_chs:"你已切换为简体",day_to_night:"你已切换为深色模式",night_to_day:"你已切换为浅色模式",bgLight:"#49b1f5",bgDark:"#1f1f1f",position:"top-center"},source:{justifiedGallery:{js:"https://gcore.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js",css:"https://gcore.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css"}},isPhotoFigcaption:!1,islazyload:!0,isAnchor:!1}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"Nodejs学习",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2020-07-06 10:53:26"}</script><noscript><style>#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(e=>{e.saveToLocal={set:function(e,t,o){if(0===o)return;const a=864e5*o,c={value:t,expiry:(new Date).getTime()+a};localStorage.setItem(e,JSON.stringify(c))},get:function(e){const t=localStorage.getItem(e);if(!t)return;const o=JSON.parse(t);if(!((new Date).getTime()>o.expiry))return o.value;localStorage.removeItem(e)}},e.getScript=e=>new Promise((t,o)=>{const a=document.createElement("script");a.src=e,a.async=!0,a.onerror=o,a.onload=a.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(a.onload=a.onreadystatechange=null,t())},document.head.appendChild(a)}),e.activateDarkMode=function(){document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},e.activateLightMode=function(){document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","ffffff")};const t=saveToLocal.get("theme"),o=window.matchMedia("(prefers-color-scheme: dark)").matches,a=window.matchMedia("(prefers-color-scheme: light)").matches,c=window.matchMedia("(prefers-color-scheme: no-preference)").matches,n=!o&&!a&&!c;if(void 0===t){if(a)activateLightMode();else if(o)activateDarkMode();else if(c||n){const e=(new Date).getHours();e<=6||e>=18?activateDarkMode():activateLightMode()}window.matchMedia("(prefers-color-scheme: dark)").addListener((function(e){void 0===saveToLocal.get("theme")&&(e.matches?activateDarkMode():activateLightMode())}))}else"light"===t?activateLightMode():activateDarkMode();const i=saveToLocal.get("aside-status");void 0!==i&&("hide"===i?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})(window)</script><style>.app-refresh{position:fixed;top:-2.2rem;left:0;right:0;z-index:99999;padding:0 1rem;font-size:15px;height:2.2rem;transition:all .3s ease}.app-refresh-wrap{display:flex;color:#fff;height:100%;align-items:center;justify-content:center}.app-refresh-wrap a{color:#fff;text-decoration:underline;cursor:pointer}</style><link rel="stylesheet" href="https://gcore.jsdelivr.net/gh/zykjofficial/zykjofficial.github.io@master/css/zykjcss.css" media="all" onload='this.media="all",this.onload=null'><meta name="generator" content="Hexo 6.0.0"><link rel="alternate" href="/atom.xml" title="ZYKJ's Blog" type="application/atom+xml"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/zykjofficial/zykjofficial.github.io@master/img/avatar.png" onerror='onerror=null,src="https://gcore.jsdelivr.net/gh/zykjofficial/zykjofficial.github.io@master/img/friend_404.gif"' alt="avatar"></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">44</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">52</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">36</div></a></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-house-user"></i> <span>主页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fa fa-book"></i> <span>文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-archive"></i> <span>归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i> <span>标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-folder-open"></i> <span>分类</span></a></li><li><a class="site-page child" href="/random_post/"><i class="fa-fw fas fa-random"></i> <span>随机</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fa fa-th-list"></i> <span>娱乐</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/bangumis/"><i class="fa-fw fa fa-film"></i> <span>番剧</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fa fa-image"></i> <span>相册</span></a></li><li><a class="site-page child" href="/baidu/"><i class="fa-fw fa-fw fab fa-html5"></i> <span>百度</span></a></li><li><a class="site-page child" href="/random/"><i class="fa-fw fas fa-random"></i> <span>选人</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/game/arknights/"><i class="fa-fw fa-solid fa-gamepad"></i> <span>Arknights</span></a></div><div class="menus_item"><a class="site-page" href="/message/"><i class="fa-fw fa fa-comments"></i> <span>留言</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i> <span>友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-info-circle"></i> <span>关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url(https://gcore.jsdelivr.net/gh/zykjofficial/zykjimg/img/nodejsstudy-cover.png)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">ZYKJ's Blog</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i> <span>搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-house-user"></i> <span>主页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fa fa-book"></i> <span>文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-archive"></i> <span>归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i> <span>标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-folder-open"></i> <span>分类</span></a></li><li><a class="site-page child" href="/random_post/"><i class="fa-fw fas fa-random"></i> <span>随机</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fa fa-th-list"></i> <span>娱乐</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/bangumis/"><i class="fa-fw fa fa-film"></i> <span>番剧</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fa fa-image"></i> <span>相册</span></a></li><li><a class="site-page child" href="/baidu/"><i class="fa-fw fa-fw fab fa-html5"></i> <span>百度</span></a></li><li><a class="site-page child" href="/random/"><i class="fa-fw fas fa-random"></i> <span>选人</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/game/arknights/"><i class="fa-fw fa-solid fa-gamepad"></i> <span>Arknights</span></a></div><div class="menus_item"><a class="site-page" href="/message/"><i class="fa-fw fa fa-comments"></i> <span>留言</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i> <span>友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-info-circle"></i> <span>关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Nodejs学习</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-07-06T02:53:26.000Z" title="发表于 2020-07-06 10:53:26">2020-07-06</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2020-07-06T02:53:26.000Z" title="更新于 2020-07-06 10:53:26">2020-07-06</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Web%E6%95%99%E7%A8%8B/">Web教程</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Web%E6%95%99%E7%A8%8B/Nodejs/">Nodejs</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">10.7k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>39分钟</span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="Nodejs学习"><a href="#Nodejs学习" class="headerlink" title="Nodejs学习"></a>Nodejs学习</h2><div class="note danger flat"><p>本教程里的资料来源于网友的资料，自己整理以供学习。</p></div><h3 id="Nodejs"><a href="#Nodejs" class="headerlink" title="Nodejs"></a>Nodejs</h3><h4 id="什么是Node-js"><a href="#什么是Node-js" class="headerlink" title="什么是Node.js"></a>什么是Node.js</h4><ol><li>基于谷歌ChromeV8引擎的JS运行环境(<code>不是框架不是库，而是一个可以不通过浏览器而解析JS语言的运行环境</code>)，Node中只有一些服务器操作级别API(如文件读写、网络服务构建、网络通信、http服务器等)，没有BOM&#x2F;DOM</li><li>Node是通过事件驱动、无阻塞输入输出模型而实现轻量和高效的</li><li>Node生态包npm是世界上最大的开源库生态系统</li></ol><h4 id="Node-js可以做什么"><a href="#Node-js可以做什么" class="headerlink" title="Node.js可以做什么"></a>Node.js可以做什么</h4><ol><li>Web服务器后台</li><li>命令行工具(npm、git、hexo)</li><li>游戏服务器</li></ol><h4 id="npm"><a href="#npm" class="headerlink" title="npm"></a>npm</h4><blockquote><p>(node package manager: node包管理器)</p></blockquote><div class="note info flat"><p>package.json (包描述文件)</p></div><p>一个项目最好有一个package.json文件，可以保存你在开发过程中安装的包的信息</p><p>在安装包的时候 使用 <code>npm install --save 包名</code> 安装 即会自动将包名添加到<code>package.json</code>中，也可以通过<code>npm init</code> 初始化创建</p><p>如果移植项目，且有<code>package.json</code>文件，则可以直接执行<code>npm install</code>安装这些包</p><div class="note info flat"><p>常用命令：</p></div><ul><li><p><code>npm --version</code> 查看版本</p></li><li><p><code>npm install --global npm</code> 升级npm</p></li><li><p><code>npm init</code> 生成package.json包</p></li><li><p><code>npm init -y</code> 省略向导生成package.json包</p></li><li><p><code>npm install 包名 (缩写: npm i 包名)</code> 安装包名(只下载)</p></li><li><p><code>npm install 包名 --save (缩写: npm i-S 包名)</code> 下载并且保存为package.json文件中的依赖项</p></li><li><p><code>npm i --save-dev</code> 中的dev代表这个包只是暂时使用，上线后即销毁不再使用用，在packjson文件里会保存在<code>devDependencies</code>项里，当我们转移项目使用<code>npm install --production</code>命令安装依赖包时会忽略<code>devDependencies</code>里的包</p></li><li><p><code>npm uninstall 包名 (缩写: npm un 包名)</code> 卸载包(只删除，依旧保留依赖项)</p></li><li><p><code>npm uninstall --save 包名 (缩写: npm un -S 包名)</code> 卸载包，同时删除依赖项</p></li><li><p><code>npm help</code> 查看使用帮助</p></li><li><p><code>npm 命令 --help</code> 查看该命令的使用帮助</p></li></ul><h4 id="如何利用Node-js解析js文件"><a href="#如何利用Node-js解析js文件" class="headerlink" title="如何利用Node.js解析js文件"></a>如何利用Node.js解析js文件</h4><ol><li><p>创建编写js文件</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Hello world&quot;</span>)</span><br></pre></td></tr></table></figure></li><li><p>输入 node +文件名 解析执行</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/zykjofficial/zykjimg/img/20200705170044.png" alt="20200705170044.png"></p></li></ol><h3 id="原生Node-js"><a href="#原生Node-js" class="headerlink" title="原生Node.js"></a>原生Node.js</h3><h4 id="Node-js中的JavaScript"><a href="#Node-js中的JavaScript" class="headerlink" title="Node.js中的JavaScript"></a>Node.js中的JavaScript</h4><p>包含四大部分:</p><ol><li>即原本的ECMAScript</li><li>node定义的核心模块，包含了很多服务器级别的API(如fs、url、http、os等)</li><li>第三方模块(通过npm下载的模块，如art-template)</li><li>用户自定义模块(自己创建的js文件)</li></ol><h5 id="模块的加载"><a href="#模块的加载" class="headerlink" title="模块的加载"></a>模块的加载</h5><ul><li><p>语法: <code>require(模块名)</code></p></li><li><p>require的作用:</p><ol><li><p>执行外部模块中的语句</p></li><li><p>拿到被加载文件导出的接口对象<code>export(即核心模块的原理)</code></p></li></ol></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取操作系统信息 </span></span><br><span class="line"><span class="keyword">var</span> os = <span class="built_in">require</span>(<span class="string">&#x27;os&#x27;</span>); </span><br><span class="line"><span class="comment">//操作路径 </span></span><br><span class="line"><span class="keyword">var</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br></pre></td></tr></table></figure><p><code>require亦可引入自定义模块</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>(<span class="string">&#x27;./test.js&#x27;</span>);</span><br></pre></td></tr></table></figure><p>注意:</p><ol><li><p>相对路径必须加<code>./</code></p></li><li><p>可以忽略<code>后缀名</code></p></li><li><p>node没有全局作用域，没有文档一说，只有模块作用域，一个js文件中的变量函数无法直接被外部引用，想引用只能通过export对象</p></li></ol><h5 id="利用require引用其他js文件中的变量函数"><a href="#利用require引用其他js文件中的变量函数" class="headerlink" title="利用require引用其他js文件中的变量函数"></a>利用require引用其他js文件中的变量函数</h5><blockquote><p>利用接口对象<code>exports</code>或者<code>module.exports</code></p></blockquote><ul><li><p>导出多个变量</p><p><code>exports.变量名 = xxx;</code></p><p><code>module.exports.变量名 = xxx;</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//b.js中的代码 </span></span><br><span class="line"><span class="keyword">var</span> foo =<span class="string">&#x27;hello&#x27;</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">add</span>(<span class="params">x,y</span>) &#123; </span><br><span class="line">    <span class="keyword">return</span> x+y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">exports</span>.<span class="property">foo</span> = foo;</span><br><span class="line"><span class="built_in">exports</span>.<span class="property">add</span> = add;</span><br><span class="line"></span><br><span class="line"><span class="comment">// a.js中的代码 </span></span><br><span class="line"><span class="keyword">var</span> b = <span class="built_in">require</span>(<span class="string">&#x27;./b.js&#x27;</span>); <span class="comment">//返回b.js中的export对象给bbianliang </span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(b.<span class="property">foo</span> +<span class="string">&#x27; world!&#x27;</span>); <span class="comment">//输出hello world!</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(b.<span class="title function_">add</span>(<span class="string">&#x27;hello&#x27;</span>,<span class="string">&#x27;world&#x27;</span>)); <span class="comment">//输出helloworld </span></span><br></pre></td></tr></table></figure></li><li><p>如果想直接导出一个变量，则必须用以下形式:</p><p><code>module.exports = 变量</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>];</span><br></pre></td></tr></table></figure><p>这样引入这个模块时就<code>直接得到一个数组而不用对象的属性获取</code></p></li><li><p>原理: 每个模块都有一个<code>module对象</code>，里面<code>存着exports对象</code>，每个模块最后都默认<code>返回module.exports</code>，而直接使用的exports是对这个属性的引用，存储的是module.exports对象的地址，所以如果直接对exports直接赋值是无法改变module.exports的值的，只能在根本上改变，即直接改变module.exports的值</p></li></ul><h5 id="模块的加载顺序"><a href="#模块的加载顺序" class="headerlink" title="模块的加载顺序"></a>模块的加载顺序</h5><p>模块会优先从缓存中加载，例如下面:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//main.js </span></span><br><span class="line"><span class="built_in">require</span>(<span class="string">&#x27;./a.js&#x27;</span>); </span><br><span class="line"><span class="keyword">var</span> fn = <span class="built_in">require</span>(<span class="string">&#x27;./b.js&#x27;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(fn); </span><br><span class="line"></span><br><span class="line"><span class="comment">//a.js </span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;a.js has been loaded!&#x27;</span>); </span><br><span class="line"><span class="keyword">var</span> fn = <span class="built_in">require</span>(<span class="string">&#x27;./b.js&#x27;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(fn); </span><br><span class="line"></span><br><span class="line"><span class="comment">//b.js </span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;b.js has been loaded!&#x27;</span>);</span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123; </span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;1&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>结果:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">a.js has been loaded!</span><br><span class="line">b.js has been loaded!</span><br><span class="line">[Function]</span><br><span class="line">[Function]</span><br></pre></td></tr></table></figure><p>解析: 结果不会出现两次<code>b.js has been loaded!</code>，因为a中已经加载过b了，所以不会再次执行，但是还是会取得其中接口对象，这样的优点是避免重复加载，提高效率。</p><h5 id="三种模块的加载原理"><a href="#三种模块的加载原理" class="headerlink" title="三种模块的加载原理"></a>三种模块的加载原理</h5><blockquote><p>用户自定义模块: 如果发现为路径形式的模块，则直接按照路径加载</p></blockquote><p><code>./</code> :当前目录(文件操作可以忽略，自定义模块标识符必须有)</p><p><code>../</code> :上一级目录</p><p><code>/</code> : 当前文件所属磁盘根路径(<code>C:/</code> <code>D:/</code>) 几乎不用</p><br><blockquote><p>核心模块: 核心模块的本质也是文件，已经被编译到二进制文件中 按照名字加载即可</p></blockquote><br><blockquote><p>第三方模块: 凡是第三方模块都必须通过npm来下载，使用的时候通过<code>require(&#39;包名&#39;)</code>的形式加载才可以使用</p></blockquote><p>步骤:</p><ol><li><p>如果判断不是为核心模块也不是路径形式，则会找当前文件所处目录下的<code>node_module</code>目录下的同名目录中<code>package.json</code>中的main属性 main属性包含了入口模块 然后加载指向的文件</p></li><li><p>如果<code>package.json</code>文件不存在或者main指定的入口模块也没有 就会自动找目录下的index.js index.js为默认备选项</p></li><li><p>如果以上所有都不成立则会进入上一级目录中的node_module目录查找</p></li><li><p>如果上一级还没有，则继续往上一级查找 直至报错</p></li></ol><p>注意: 一个项目有且只能有一个<code>node_module</code>文件夹</p><h4 id="fs文件操作模块"><a href="#fs文件操作模块" class="headerlink" title="fs文件操作模块"></a>fs文件操作模块</h4><blockquote><p>Nodejs有文件操作能力，通过引入文件系统模块，其中包含了各种文件操作API</p></blockquote><h5 id="读取文件"><a href="#读取文件" class="headerlink" title="读取文件"></a>读取文件</h5><p>步骤:</p><ol><li><p>首先用<code>require</code>引入模块，需要什么功能，就引入什么模块，引入模块其实就相当于引入一些相关语法。操控文件则要引入<code>file-system</code>模块，用字符串fs表示</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br></pre></td></tr></table></figure></li><li><p>利用fs模块的readFile方法读取文件</p><p><code>fs模块变量.readFile(文件地址，可选参数[编码格式],回调函数(error，data)&#123;&#125;)</code></p><p>回调函数有两个参数，<code>第一个是读取发生错误时返回的错误对象</code>，<code>第二个是读取的数据,读取后的数据是二进制代码</code>，可以在回调函数中将其转为字符串，JS中的转换成字符串的方法都能实现<code>toString</code> <code>String + &quot;&quot;</code>、也可以传入<code>第二个可选参数进行配置</code>，读取后的文件会自动按照其值解码。如传入<code>&#39;utf8&#39;</code>,则会按照<code>utf8解码</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">fs.<span class="title function_">readFile</span>(<span class="string">&#x27;write.txt&#x27;</span>,<span class="keyword">function</span>(<span class="params">error,data</span>)&#123;	</span><br><span class="line">    <span class="keyword">if</span>(error) &#123; 	</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;读取文件失败&#x27;</span>); </span><br><span class="line">    &#125; <span class="keyword">else</span> &#123; </span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(data +<span class="string">&#x27;&#x27;</span>); </span><br><span class="line">    &#125; </span><br><span class="line">&#125;); </span><br><span class="line"></span><br><span class="line">fs.<span class="title function_">readFile</span>(<span class="string">&#x27;write.txt&#x27;</span>,<span class="string">&#x27;utf8&#x27;</span>,<span class="keyword">function</span>(<span class="params">error,data</span>)&#123;	</span><br><span class="line">    <span class="keyword">if</span>(error) &#123; 	</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;读取文件失败&#x27;</span>); </span><br><span class="line">    &#125; <span class="keyword">else</span> &#123; </span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(data);</span><br><span class="line">    &#125; </span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li></ol><h5 id="写入文件"><a href="#写入文件" class="headerlink" title="写入文件"></a>写入文件</h5><p>步骤:</p><ol><li><p>首先用require引入模块，需要什么功能，就引入什么模块，操控文件则要引入file-system模块，用字符串fs表示</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br></pre></td></tr></table></figure></li><li><p>使用fs模块的writeFile方法</p><p><code>fs模块变量.writeFile(文件地址，写入内容，回调函数(error)&#123;&#125;)</code></p><p>回调函数有一个形参error，用于写入错误时返回错误信息</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">fs.<span class="title function_">writeFile</span>(<span class="string">&#x27;./write.txt&#x27;</span>,<span class="string">&#x27;hello world！！！！！&#x27;</span>,<span class="keyword">function</span>(<span class="params">error</span>)&#123; </span><br><span class="line">    <span class="keyword">if</span>(error) &#123; 	</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;写入失败&#x27;</span>); <span class="comment">// console.log(error);</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123; </span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;写入成功!&#x27;</span>); </span><br><span class="line">    &#125; </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li></ol><h5 id="追加文件"><a href="#追加文件" class="headerlink" title="追加文件"></a>追加文件</h5><p><code>fs.appendFile(文件地址，追加内容，回调函数(error)&#123;&#125;)</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">fs.<span class="title function_">appendFile</span>(<span class="string">&#x27;t1.txt&#x27;</span>,<span class="string">&#x27;这是写入的内容&#x27;</span>,<span class="function">(<span class="params">err</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(err)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(err);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;追加成功&#x27;</span>);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h5 id="删除文件"><a href="#删除文件" class="headerlink" title="删除文件"></a>删除文件</h5><p><code>s.unlink(文件地址，回调函数(error)&#123;&#125;)</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  删除文件</span></span><br><span class="line">fs.<span class="title function_">unlink</span>(<span class="string">&#x27;1.txt&#x27;</span>,<span class="function">(<span class="params">err</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(err)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(err);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;删除文件成功&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h5 id="读取文件列表"><a href="#读取文件列表" class="headerlink" title="读取文件列表"></a>读取文件列表</h5><p>利用<code>fs模块</code>变量的<code>readdir</code>方法</p><p><code>fs.readdir(路径名，function(error,files) &#123;&#125;)</code></p><p>回调函数的两个参数分别是<code>错误对象</code>以及<code>读取到的文件名列表(数组形式)</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">fs.<span class="title function_">readdir</span>(<span class="string">&#x27;./read.txt&#x27;</span>,<span class="keyword">function</span> (<span class="params">error,files</span>) &#123; 	</span><br><span class="line">    <span class="keyword">if</span> (error) &#123; 		</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">end</span>(<span class="string">&#x27;404 can not found&#x27;</span>); </span><br><span class="line">    &#125;                 </span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(files);   </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="Http模块"><a href="#Http模块" class="headerlink" title="Http模块"></a>Http模块</h4><blockquote><p>Node.js中有http模块(字符串http表示)可以快速构建Web服务器</p></blockquote><h5 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h5><ol><li><p>加载http模块</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">&#x27;http&#x27;</span>);</span><br></pre></td></tr></table></figure></li><li><p>利用<code>http.createServe</code>创建服务器实例</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> server = http.<span class="title function_">createServer</span>();</span><br></pre></td></tr></table></figure></li><li><p>设置request事件，当客户端发送请求时则触发该事件并调用其回调函数</p><p><code>服务器实例.on(&quot;request&quot;,回调函数(request,response)&#123;&#125;)</code></p><p>回调函数中有两个参数<code>request</code>和<code>response</code></p><p><code>request</code></p><ul><li><p><code>req</code> : 它表示一个正在进行的请求，可以获取一些请求信息，比如请求路径</p></li><li><p><code>req.url</code>: 返回请求路径</p></li><li><p><code>req.headers</code>: 打印全部请求头信息–对象形式</p></li><li><p><code>req.method</code>: 请求的方式</p></li></ul><p><code>response</code></p><ul><li><p><code>res</code>: 可以给客户端发送响应信息</p></li><li><p><code>res.setHeader()</code>: 设置响应头，告诉客户端解码方式，如果响应的是html页面且html页面中元数据meta已经声明解码方式则可忽视</p></li><li><p><code>res.statusCode</code>: 设置状态码数字</p></li><li><p><code>res.status.message</code>: 设置状态码文字</p></li><li><p><code>res.write(相应内容)</code>: 向客户端发送响应信息 write之后必须调用end方法用以告诉客户端已经输出完毕、可以有多句res.write</p></li><li><p><code>res.end(数据)</code>: 完成发送请求 必须跟在response.write之后 每个request事件只能有一句<code>res.end</code></p><p>也可以直接通过<code>response.end</code>传送数据 <code>response.end(数据)</code> 支持字符串和二进制数据，会直接将二进制转为字符串</p></li></ul><div class="tip"><p>可以与request的url属性搭配使用实现不同请求传递不同信息</p></div><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">server.<span class="title function_">on</span>(<span class="string">&quot;request&quot;</span>,<span class="keyword">function</span>(<span class="params">request,response</span>)&#123; </span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;i got you&#x27;</span>);   </span><br><span class="line">    <span class="keyword">if</span>(request.<span class="property">url</span> == <span class="string">&#x27;/haha&#x27;</span>) &#123; </span><br><span class="line">        response.<span class="title function_">write</span>(<span class="string">&#x27;haha&#x27;</span>); <span class="comment">//如果请求的是haha地址，则页面显示haha    </span></span><br><span class="line">        response.<span class="title function_">end</span>(); <span class="comment">//结束响应</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;  </span><br><span class="line">        response.<span class="title function_">end</span>(<span class="string">&#x27;please go to /haha&#x27;</span>); <span class="comment">//如果请求的不是haha地址，则会显示左边内容   </span></span><br><span class="line">    &#125; </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><div class="tip"><p>也可以传送文件数据</p></div><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(req.<span class="property">url</span> == <span class="string">&#x27;/html&#x27;</span>) &#123; 	</span><br><span class="line">    res.<span class="title function_">setHeader</span>(<span class="string">&#x27;Content-type&#x27;</span>,<span class="string">&#x27;text/html;charset=utf-8&#x27;</span>);</span><br><span class="line">    fs.<span class="title function_">readFile</span>(<span class="string">&#x27;./resource/index.html&#x27;</span>,<span class="keyword">function</span>(<span class="params">error,data</span>)&#123; 		</span><br><span class="line">        <span class="keyword">if</span>(error) &#123; 		</span><br><span class="line">            res.<span class="title function_">end</span>(<span class="string">&#x27;读取失败!&#x27;</span>); 	</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123; 		</span><br><span class="line">            <span class="comment">// res.end支持字符串也支持二进制 所以不用转换 	</span></span><br><span class="line">            res.<span class="title function_">end</span>(data); 	</span><br><span class="line">        &#125; </span><br><span class="line">    &#125;);</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (req.<span class="property">url</span> == <span class="string">&#x27;/plain&#x27;</span>) &#123; </span><br><span class="line">    res.<span class="title function_">setHeader</span>(<span class="string">&#x27;Content-type&#x27;</span>,<span class="string">&#x27;text/plain;charset=utf-8&#x27;</span>);</span><br><span class="line">    fs.<span class="title function_">readFile</span>(<span class="string">&#x27;./resource/index.txt&#x27;</span>,<span class="keyword">function</span>(<span class="params">error,data</span>)&#123; </span><br><span class="line">        <span class="keyword">if</span>(error) &#123; 		</span><br><span class="line">            res.<span class="title function_">end</span>(<span class="string">&#x27;读取失败!&#x27;</span>); 	</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123; </span><br><span class="line">            res.<span class="title function_">end</span>(data); 		</span><br><span class="line">        &#125; </span><br><span class="line">    &#125;)</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (req.<span class="property">url</span> == <span class="string">&#x27;/img&#x27;</span>) &#123; </span><br><span class="line">    <span class="comment">// 图片的MIME类型为image/jpg 一般可以不用设定 </span></span><br><span class="line">    res.<span class="title function_">setHeader</span>(<span class="string">&#x27;Content-type&#x27;</span>,<span class="string">&#x27;image/jpg;charset=utf-8&#x27;</span>);</span><br><span class="line">    fs.<span class="title function_">readFile</span>(<span class="string">&#x27;./resource/82710.jpg&#x27;</span>,<span class="keyword">function</span>(<span class="params">error,data</span>)&#123; </span><br><span class="line">        <span class="keyword">if</span>(error) &#123; 	</span><br><span class="line">            res.<span class="title function_">end</span>(<span class="string">&#x27;读取失败！&#x27;</span>); </span><br><span class="line">        &#125; <span class="keyword">else</span> &#123; 	</span><br><span class="line">            res.<span class="title function_">end</span>(data); </span><br><span class="line">        &#125; </span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>注意: <code>response.end</code>方法支持传送二进制数据，所以不用转化获取的文件数据就可以直接发送</p></li><li><p>使用<code>listen方法</code>绑定端口号，并启动服务器对其监听，启动后调用其回调函数</p><p><code>服务器实例.listen(端口号,回调函数)</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">server.<span class="title function_">listen</span>(<span class="number">3000</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123; </span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;服务器启动成功 可以通过 http://127.0.0.1:3000 访问&#x27;</span>); </span><br><span class="line">&#125;);<span class="comment">//启动成功后，node环境中则会输出上面语句</span></span><br></pre></td></tr></table></figure></li><li><p>在node环境中打开该js文件，启动服务器(node环境中<code>ctrl+c</code>可以关闭服务器</p></li></ol><h5 id="http的重定向"><a href="#http的重定向" class="headerlink" title="http的重定向"></a>http的重定向</h5><p><code>res.statusCode = 302;</code></p><p><code>res.statusCode</code>: 此属性控制在刷新标头时将发送到客户端的状态代码</p><p><code>res.setHeader(&#39;Location&#39;,路径)</code></p><p><code>res.end()</code></p><h4 id="URL模块"><a href="#URL模块" class="headerlink" title="URL模块"></a>URL模块</h4><blockquote><p>url模块可以对url地址进行一些操作</p></blockquote><h5 id="加载模块"><a href="#加载模块" class="headerlink" title="加载模块"></a>加载模块</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> url = <span class="built_in">require</span>(<span class="string">&#x27;url&#x27;</span>)</span><br></pre></td></tr></table></figure><h5 id="解析地址方法"><a href="#解析地址方法" class="headerlink" title="解析地址方法"></a>解析地址方法</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url.<span class="title function_">parse</span>(<span class="string">&#x27;http://www.baidu.com&#x27;</span>,布尔值)</span><br></pre></td></tr></table></figure><p>返回地址的详细信息</p><p><code>其中第二个参数如果为true，则会将地址中的query参数转为对象，默认为false</code></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/zykjofficial/zykjimg/img/20200705181137.png" alt="20200705181137.png"></p><p><code>pathname</code>: 返回路径</p><p><code>query</code>: 返回参数</p><h4 id="Path模块"><a href="#Path模块" class="headerlink" title="Path模块"></a>Path模块</h4><blockquote><p>可以对路径进行操作，注意不是操作URL</p></blockquote><h5 id="加载方式"><a href="#加载方式" class="headerlink" title="加载方式"></a>加载方式</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br></pre></td></tr></table></figure><h5 id="模块方法"><a href="#模块方法" class="headerlink" title="模块方法"></a>模块方法</h5><ul><li><p><code>path.basename(路径)</code>: 获取路径中最后的文件名</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">path.<span class="title function_">basename</span>(<span class="string">&#x27;c://a/b/c/index.js&#x27;</span>,<span class="string">&#x27;.js&#x27;</span>) <span class="comment">//返回&#x27;index&#x27;</span></span><br></pre></td></tr></table></figure></li><li><p><code>parse.dirname</code>: 获取路径中的目录部分</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">path.<span class="title function_">dirname</span>(<span class="string">&#x27;c://a/b/c/index.js&#x27;</span>) <span class="comment">//返回&#x27;c://a/b/c&#x27;</span></span><br></pre></td></tr></table></figure></li><li><p><code>parse.extname</code>: 获取路径中文件的扩展名</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">path.<span class="title function_">extname</span>(<span class="string">&#x27;c://a/b/c/index.js&#x27;</span>) <span class="comment">//返回.js</span></span><br></pre></td></tr></table></figure></li><li><p><code>path.join(路径1，路径2)</code>: 将路径拼接起来</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">path.<span class="title function_">join</span>(<span class="string">&#x27;c://a/b/c&#x27;</span>,<span class="string">&#x27;index.js&#x27;</span>) <span class="comment">//返回&#x27;c://a/b/c/index.js&#x27;</span></span><br></pre></td></tr></table></figure></li><li><p><code>path.parse(路径)</code>: 将路径里的元素分别提取出来</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">path.<span class="title function_">parse</span>(<span class="string">&#x27;c://a/b/c/index.js&#x27;</span>);</span><br></pre></td></tr></table></figure></li></ul><h4 id="Node中的dirname和-filename"><a href="#Node中的dirname和-filename" class="headerlink" title="Node中的dirname和__filename"></a>Node中的<code>dirname</code>和<code>__filename</code></h4><p>node中除了require、exports等相关模块之外，还有两个特殊的成员</p><ul><li><p><code>__dirname</code>: 可以获取当前文件所属目录的绝对路径</p></li><li><p><code>__filename</code>: 可以获取当前文件的绝对路径</p></li></ul><p>注意:</p><ol><li><p>文件操作中的<code>./</code>是相对于执行终端的路径的目录而不是当前文件的目录,如果在别的路径下打开终端执行该文件则会找不到要读取的文件，所以在写文件路径时一般使用<code>path模块</code>的<code>path.join</code>将<code>__dirname</code>和文件拼接起来</p></li><li><p>在大部分文件操作路径中一般都是用绝对路径，而为了防止项目移植时绝对路径失效，所以应该使用动态的绝对路径，也就是<code>dirname</code>和<code>filename</code></p></li><li><p>模块加载中的<code>./</code>则不受影响，是相对于当前文件的目录，不需要使用<code>dirname</code>和<code>filename</code></p></li></ol><h4 id="art-template模板引擎模块"><a href="#art-template模板引擎模块" class="headerlink" title="art-template模板引擎模块"></a>art-template模板引擎模块</h4><p>步骤:</p><ol><li><p>加载模板引擎模块并赋予某个变量</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> template = <span class="built_in">require</span>(<span class="string">&#x27;art-template&#x27;</span>);</span><br></pre></td></tr></table></figure><p>注意: <code>下载的模板叫什么名字就加载时就填什么名字</code></p></li><li><p>使用模板引擎的<code>render</code>方法</p><p><code>template.render(字符串，填充对象)</code> :返回的是填充后的字符串</p><p>可以只写第一个参数快速返回一个页面，但是如果页面里有待填充的script标签则不能以这种方式发送，因为会被填充掉</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ret = template.<span class="title function_">render</span>(<span class="string">&#x27;hello &#123;&#123;name&#125;&#125;&#x27;</span>,&#123;<span class="attr">name</span>:<span class="string">&#x27;bruce&#x27;</span>&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//or</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> str = <span class="string">`&lt;!DOCTYPE html&gt; </span></span><br><span class="line"><span class="string">           &lt;html lang=&quot;en&quot;&gt;</span></span><br><span class="line"><span class="string">           &lt;head&gt;</span></span><br><span class="line"><span class="string">           &lt;meta charset=&quot;UTF-8&quot; /&gt;</span></span><br><span class="line"><span class="string">           &lt;title&gt;Document&lt;/title&gt;</span></span><br><span class="line"><span class="string">           &lt;/head&gt;</span></span><br><span class="line"><span class="string">           &lt;body&gt; </span></span><br><span class="line"><span class="string">            大家好 我叫 &#123;&#123;name&#125;&#125;, 我今年 &#123;&#123;age&#125;&#125; 岁了,我来自 &#123;&#123;province&#125;&#125; ,我喜欢 &#123;&#123;each hobbies&#125;&#123;&#123;$value&#125;&#125; &#123;&#123;/each&#125;&#125; </span></span><br><span class="line"><span class="string">           &lt;/body&gt;</span></span><br><span class="line"><span class="string">            &lt;/html&gt;`</span>; </span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ret = template.<span class="title function_">render</span>(str,&#123;<span class="attr">name</span>:<span class="string">&#x27;bruce&#x27;</span>,<span class="attr">age</span>:<span class="number">29</span>,<span class="attr">province</span>:<span class="string">&#x27;guangdong&#x27;</span>,<span class="attr">hobbies</span>:[<span class="string">&#x27;dance&#x27;</span>,<span class="string">&#x27;sing&#x27;</span>,<span class="string">&#x27;rap&#x27;</span>,<span class="string">&#x27;basketball&#x27;</span>]&#125;);</span><br></pre></td></tr></table></figure><p>如果要填充的是外部的文件，则读取文件后要记得将其转为字符串</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>); </span><br><span class="line"><span class="keyword">var</span> content = &#123;<span class="attr">name</span>:<span class="string">&#x27;bruce&#x27;</span>,<span class="attr">age</span>:<span class="number">29</span>,<span class="attr">province</span>:<span class="string">&#x27;guangdong&#x27;</span>,<span class="attr">hobbies</span>:[<span class="string">&#x27;dance&#x27;</span>,<span class="string">&#x27;sing&#x27;</span>,<span class="string">&#x27;rap&#x27;</span>,<span class="string">&#x27;basketball&#x27;</span>]&#125;;</span><br><span class="line"></span><br><span class="line">fs.<span class="title function_">readFile</span>(<span class="string">&#x27;template.html&#x27;</span>,<span class="keyword">function</span>(<span class="params">error,data</span>)&#123; </span><br><span class="line">    <span class="keyword">if</span>(error) &#123; 	</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;404 not found&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    data = data.<span class="title function_">toString</span>(); </span><br><span class="line">    <span class="keyword">var</span> ret = template.<span class="title function_">render</span>(data,content);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(ret);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>配合<code>http模块</code>使用</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">&#x27;http&#x27;</span>); </span><br><span class="line"><span class="keyword">var</span> server = http.<span class="title function_">createServer</span>(); </span><br><span class="line"></span><br><span class="line">server.<span class="title function_">on</span>(<span class="string">&#x27;request&#x27;</span>,<span class="keyword">function</span>(<span class="params">req,res</span>) &#123; </span><br><span class="line">    <span class="keyword">if</span>(req.<span class="property">url</span> === <span class="string">&#x27;/template&#x27;</span>) &#123; 	</span><br><span class="line">        fs.<span class="title function_">readFile</span>(<span class="string">&#x27;template.html&#x27;</span>,<span class="keyword">function</span>(<span class="params">error,data</span>)&#123; </span><br><span class="line">            <span class="keyword">if</span>(error) &#123; 		</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;404 not found&#x27;</span>); </span><br><span class="line">            &#125; 		</span><br><span class="line">            data = data.<span class="title function_">toString</span>(); 	</span><br><span class="line">            <span class="keyword">var</span> ret = template.<span class="title function_">render</span>(data,content); 	</span><br><span class="line">            res.<span class="title function_">end</span>(ret);</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125; </span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">server.<span class="title function_">listen</span>(<span class="string">&#x27;3000&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123; </span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;running...&#x27;</span>);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li></ol><h4 id="formidable模块实现文件上传"><a href="#formidable模块实现文件上传" class="headerlink" title="formidable模块实现文件上传"></a>formidable模块实现文件上传</h4><blockquote><p>利用formidable第三方模块可以实现文件的上传</p></blockquote><p>使用步骤:</p><ol><li><p>安装</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i --S formidable</span><br></pre></td></tr></table></figure></li><li><p>加载</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> formidable = <span class="built_in">require</span>(<span class="string">&#x27;formidable&#x27;</span>);</span><br></pre></td></tr></table></figure></li><li><p>路由监听配置</p><ol><li><p>先创建一个form对象用以接收文件</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> form  = <span class="keyword">new</span> formidable.<span class="title class_">IncomingForm</span>()</span><br></pre></td></tr></table></figure></li><li><p>进行配置(可选)</p><p><code>form.encoding = &quot;utf-8&quot;</code>: 设置文件解码方式</p><p><code>form.uploadDir = __dirname + &#39;/img&#39;</code>: 设置上传文件存放位置</p><p><code>form.keepExtensions = true;</code>: 设置文件是否保留后缀名</p><p><code>form.multiples = true;</code>: 设置是否为多个文件，如果为true，则files参数会以数组显示</p></li><li><p>对文件解析并用回调函数进行操作</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">form.<span class="title function_">parse</span>(req,<span class="keyword">function</span>(<span class="params">err,fields,files</span>)&#123;&#125;</span><br></pre></td></tr></table></figure><p>文件解析后，文件信息解析完成后会挂载到req上，文本的信息将挂载到fileds上，文件的信息将挂载到files上面(包括存放的绝对地址、文件大小、文件名字、文件mime类型)。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/files&#x27;</span>,<span class="keyword">function</span>(<span class="params">req,res</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> form = <span class="keyword">new</span> formidable.<span class="title class_">IncomingForm</span>();</span><br><span class="line">    form.<span class="property">keepExtensions</span> = <span class="literal">true</span>;</span><br><span class="line">    form.<span class="property">multiples</span> = <span class="literal">true</span>;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(form.<span class="property">type</span>);</span><br><span class="line">    form.<span class="property">uploadDir</span> = path.<span class="title function_">join</span>(__dirname,<span class="string">&quot;/img&quot;</span>);</span><br><span class="line">    form.<span class="title function_">parse</span>(req, <span class="keyword">function</span>(<span class="params">err, fields, files</span>) &#123;</span><br><span class="line">        res.<span class="title function_">setHeader</span>(<span class="string">&#x27;Content-type&#x27;</span>,<span class="string">&#x27;text/plain;charset=utf8&#x27;</span>);</span><br><span class="line">        res.<span class="title function_">end</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123;fields,files&#125;))</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li></ol></li></ol><h4 id="客户端渲染数据和服务端渲染数据的区别"><a href="#客户端渲染数据和服务端渲染数据的区别" class="headerlink" title="客户端渲染数据和服务端渲染数据的区别"></a>客户端渲染数据和服务端渲染数据的区别</h4><ul><li><p>客户端渲染(SPA:single page application): 用户通过地址栏或者链接标签进入一个新的链接后，向服务器<code>发出请求</code>，<code>服务器直接根据链接返回一个html页面(没有数据)</code>，页面中的<code>数据渲染则是由页面中的ajax完成</code>，<code>ajax再次向服务器发出请求数据的请求</code>，然后<code>对页面进行渲染</code></p><p>简单理解即浏览器发送页面请求，服务器返回的是一个模板页面，浏览器从上至下解析过程中需要发送ajax请求获取数据，最后再调用模板引擎(art-template等)渲染HTML结构，并把渲染后的结果添加到页面指定容器中。</p></li><li><p>服务端渲染(SSR:server side rendering): 用户通过地址栏或者链接进入一个服务器所监听的服务器的路径，服务器则根据<code>该路径返回一个页面(有数据)</code>，页面的数据渲染在服务器内由服务器完成，<code>客户端只需要发送一次请求</code>，<code>不用ajax</code></p><p>以Node为例，就是服务器根据请求<code>req.url</code>读取对应html页面，将其转为字符串，再利用模板引擎将从数据库读取到数据渲染到页面中的某个结构中，再将这个字符串用<code>res.end()</code>发送出去</p></li></ul><div class="tip"><p>如何区分两者？</p></div><p>服务端渲染的页面数据可以通过浏览器审查元素看到。而客户端无法看到。</p><br><div class="tip"><p>两者本质的区别？</p></div><p>客户端渲染和服务器端渲染的最重要的区别就是究竟是谁来完成html文件的完整拼接，如果是在服务器端完成的，然后返回给客户端，就是服务器端渲染，而如果是前端做了更多的工作完成了html的拼接，则就是客户端渲染。</p><br><div class="tip"><p>服务器端渲染的优缺点是？</p></div><p>优点:</p><ol><li>前端耗时少。因为后端拼接完了html，浏览器只需要直接渲染出来。</li><li>有利于SEO。因为在后端有完整的html页面，所以爬虫更容易爬取获得信息，更有利于SEO。</li><li>无需占用客户端资源。即解析模板的工作完全交由后端来做，客户端只要解析标准的html页面即可，这样对于客户端的资源占用更少，尤其是移动端，也可以更省电。</li><li>后端生成静态化文件。即生成缓存片段，这样就可以减少数据库查询浪费的时间了，且对于数据变化不大的页面非常高效 。</li></ol><p>缺点:</p><ol><li>不利于前后端分离，开发效率低。使用服务器端渲染，则无法进行分工合作，则对于前端复杂度高的项目，不利于项目高效开发。另外，如果是服务器端渲染，则前端一般就是写一个静态html文件，然后后端再修改为模板，这样是非常低效的，并且还常常需要前后端共同完成修改的动作； 或者是前端直接完成html模板，然后交由后端。另外，如果后端改了模板，前端还需要根据改动的模板再调节css，这样使得前后端联调的时间增加。</li><li>占用服务器端资源。即服务器端完成html模板的解析，如果请求较多，会对服务器造成一定的访问压力。而如果使用前端渲染，就是把这些解析的压力分摊了前端，而这里确实完全交给了一个服务器。</li></ol><br><div class="tip"><p>客户端渲染的优缺点是？</p></div><p>优点:</p><ol><li>前后端分离。前端专注于前端UI，后端专注于api开发，且前端有更多的选择性，而不需要遵循后端特定的模板。</li><li>体验更好。比如，我们将网站做成SPA或者部分内容做成SPA，这样，尤其是移动端，可以使体验更接近于原生app。</li></ol><p>缺点:</p><ol><li>前端响应较慢。如果是客户端渲染，前端还要进行拼接字符串的过程，需要耗费额外的时间，不如服务器端渲染速度快。</li><li>不利于SEO。目前比如百度、谷歌的爬虫对于SPA都是不认的，只是记录了一个页面，所以SEO很差。因为服务器端可能没有保存完整的html，而是前端通过js进行dom的拼接，那么爬虫无法爬取信息。 除非搜索引擎的seo可以增加对于JavaScript的爬取能力，这才能保证seo。</li></ol><h3 id="REPL-read-eval-print-loop"><a href="#REPL-read-eval-print-loop" class="headerlink" title="REPL(read eval print loop)"></a>REPL(read eval print loop)</h3><blockquote><p>代表一个快速的检测API的方法</p></blockquote><p>在命令行中输入node，回车就可以直接执行js代码进行一些node的api的测试</p><h3 id="Express框架的使用"><a href="#Express框架的使用" class="headerlink" title="Express框架的使用"></a>Express框架的使用</h3><blockquote><p>Express 是一个简洁而灵活的 node.js Web应用框架, 提供了一系列强大特性帮助你创建各种 Web 应用，和丰富的 HTTP 工具。<br>使用 Express 可以快速地搭建一个完整功能的网站。</p></blockquote><ol><li><p>安装</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save express</span><br></pre></td></tr></table></figure></li><li><p>加载包</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br></pre></td></tr></table></figure></li><li><p>创建服务器</p><p><code>var 变量 = express()</code></p><p>相当于<code>var server = http.createServer()</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> app = <span class="title function_">express</span>();</span><br></pre></td></tr></table></figure></li><li><p>两种路由</p><ul><li><p>接收get方式</p><p><code>app.get(path,function(req,res)&#123;&#125;)</code></p><p>当服务器收到get请求路径<code>path(第一个参数)</code>的时候，触发事件 相当于<code>server.on(&#39;request&#39;,function(req,res))</code>以及其中地址判断的封装</p><p>第一个参数可以是具体的路径、路径模式、正则表达式的路径模式、以及这三者集合起来的数组</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>,<span class="keyword">function</span>(<span class="params">req,res</span>)&#123;</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&#x27;hello express!&#x27;</span>);   </span><br><span class="line">    res.<span class="title function_">send</span>(req.<span class="property">query</span>); </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>注意: 使用<code>res.send</code>发送会自动解码不需要设置响应头，可以通过<code>req.query</code>属性快速获取get方式提交的参数</p></li><li><p>接收post方式</p><p><code>app.post(path,function(req,res)&#123;&#125;)</code></p></li></ul></li><li><p>监听</p><p><code>app.listen(端口号，function()&#123;&#125;)</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">listen</span>(<span class="number">3000</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123; </span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;app is running at port 3000.&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li></ol><h4 id="express的中间件概念"><a href="#express的中间件概念" class="headerlink" title="express的中间件概念"></a>express的中间件概念</h4><p>中间件就是http请求和服务器响应之间对请求的处理函数，通过中间件，可以对数据进行操作使得我们能方便地操作请求数据编写服务器响应。如<code>body-parse中间件</code>对post请求的参数进行处理让我们可以通过<code>res.body</code>快速获取请求参数，<code>express-session</code>中间件可以让我们对数据进行保存，<code>express.static是express内置中间件</code>，可以让我们快速处理静态资源，<code>express.Router路由中间件</code>等等</p><p>Express中，对中间进行了几种分类:</p><ol><li>不关心请求路径和请求方法的中间件，通过<code>app.use</code>函数实现</li></ol><p><code>app.use(function(req,res,next)&#123;&#125;)</code></p><p>客户端发起的任意请求都会经过这个中间件函数进行处理</p><p>next指下一个满足路径条件的中间件，如果有执行next，那么这个<code>中间件执行完后就会执行下一个满足条件的中间件</code>，<code>如果没有next，就会忽略后面所有中间件</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">use</span>(<span class="keyword">function</span>(<span class="params">req,res,next</span>) &#123; </span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;1&#x27;</span>);</span><br><span class="line">    <span class="comment">//满足所有、执行下一个满足条件</span></span><br><span class="line">    <span class="title function_">next</span>();</span><br><span class="line">&#125;) </span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/a&#x27;</span>,<span class="keyword">function</span>(<span class="params">req,res,next</span>) &#123; </span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;aa&#x27;</span>);</span><br><span class="line">&#125;) </span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/b&#x27;</span>,<span class="keyword">function</span>(<span class="params">req,res,next</span>) &#123; </span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;bb&#x27;</span>);</span><br><span class="line">&#125;) </span><br><span class="line"></span><br><span class="line"><span class="comment">//输入/b路径 结果为1  bb</span></span><br></pre></td></tr></table></figure><ol start="2"><li><p>关心请求路径的中间件,通过app.use函数实现</p><p><code>app.use(路径，function(req,res,next)&#123;&#125;)</code></p><p>客户端发起的以第一个参数开头的路径才会进入该中间件</p></li><li><p>严格匹配路径的中间件，通过<code>app.get/app.post</code>等实现</p></li></ol><p><code>中间件的执行机制</code></p><ol><li><p>中间件的第一次执行是同步的，当一个请求发出到达服务器后，则按照顺序匹配所有中间件，当找到一个匹配时，则进入该中间件</p></li><li><p>如果该中间件最后没有执行next函数，则该请求在此中间件终止，如果有，则会直接进入后面匹配的中间件中(不是按顺序！)</p></li><li><p>重复1-2步</p></li></ol><p>所以，对于一些封装请求数据方便我们操作以及处理静态资源的中间件我们应该放在路由之前编写，否则在编写路由时就无法使用封装好的数据。而对于404页面应该放在所有中间件后面，这样无法找到的页面则会返回404页面</p><p><code>中间件日志</code></p><p>通过无路径中间件来写入每一次http请求到日志中</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">use</span>(<span class="function">(<span class="params">req,res,next</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> log = <span class="string">`请求方法:<span class="subst">$&#123;req.method&#125;</span>,请求URL:<span class="subst">$&#123;req.url&#125;</span>,请求路径:<span class="subst">$&#123;req.path&#125;</span>,请求时间:<span class="subst">$&#123;<span class="keyword">new</span> <span class="built_in">Date</span>()&#125;</span>`</span>; </span><br><span class="line">    fs.<span class="title function_">appendFile</span>(<span class="string">&#x27;./log.txt&#x27;</span>,log,<span class="function">(<span class="params">err</span>) =&gt;</span> &#123; 	</span><br><span class="line">        <span class="keyword">if</span>(err) &#123; 	</span><br><span class="line">            <span class="keyword">return</span> res.<span class="title function_">end</span>(<span class="string">&#x27;日志写入失败&#x27;</span>);</span><br><span class="line">        &#125; </span><br><span class="line">        <span class="title function_">next</span>();</span><br><span class="line">    &#125;) </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p><code>错误日志中间件</code></p><ol><li><p>利用<code>try...catch...</code>捕获路由解析中发生的错误，将其写入错误日志</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>,<span class="function">(<span class="params">req,res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123; </span><br><span class="line">        <span class="keyword">const</span> msg = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(&#123;<span class="string">&#x27;abc&#x27;</span>&#125;); </span><br><span class="line">        res.<span class="title function_">json</span>(msg); </span><br><span class="line">    &#125; <span class="keyword">catch</span>(e) &#123; 	</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(e.<span class="property">message</span>); </span><br><span class="line">    &#125; </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>访问日志和错误日志都可以写成单独一个中间件保存到数据库中</p></li><li><p>错误收集统一处理中间件</p><p>中间件回调函数参数如果是四个，第一个就是前面中间件中next返回的错误对象</p><p>注意: 一定要四个参数 才能正确接收错误对象</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">use</span>(<span class="function">(<span class="params">err,req,res,next</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> error_log = <span class="string">`</span></span><br><span class="line"><span class="string">	错误名:<span class="subst">$&#123;err.name&#125;</span> </span></span><br><span class="line"><span class="string">	错误信息:<span class="subst">$&#123;err.message&#125;</span> </span></span><br><span class="line"><span class="string">	错误堆栈:<span class="subst">$&#123;err.stack&#125;</span> </span></span><br><span class="line"><span class="string">	错误时间:<span class="subst">$&#123;<span class="keyword">new</span> <span class="built_in">Date</span>()&#125;</span></span></span><br><span class="line"><span class="string">	`</span></span><br><span class="line">    fs.<span class="title function_">appendFile</span>(<span class="string">&#x27;./err_log.txt&#x27;</span>,error_log,<span class="function"><span class="params">err</span> =&gt;</span> &#123; 	</span><br><span class="line">        res.<span class="title function_">writeHead</span>(<span class="number">500</span>,&#123;&#125;); </span><br><span class="line">        res.<span class="title function_">end</span>(<span class="string">&#x27;500 服务器正忙，请稍后重试&#x27;</span>); </span><br><span class="line">    &#125;) </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li></ol><h4 id="express快速处理静态资源-使用express-static中间件"><a href="#express快速处理静态资源-使用express-static中间件" class="headerlink" title="express快速处理静态资源(使用express.static中间件)"></a>express快速处理静态资源(使用express.static中间件)</h4><p><code>express.static(root，[选项])</code>: 该root参数指定要从其提供静态资产的根目录。该功能通过<code>req.url</code>与提供的root目录结合来确定要提供的文件。当找不到文件时，它不会发送404响应，而是调用<code>next()</code>继续前进到下一个中间件，从而允许堆栈和回退。</p><p><code>express.use(以什么路径开头，express.static(公开的资源的目录))</code></p><p>当以<code>/public开头</code>时，去路径<code>./public/</code>目录中找对应的资源</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/public&#x27;</span>,express.<span class="title function_">static</span>(<span class="string">&#x27;./public/&#x27;</span>));</span><br></pre></td></tr></table></figure><p>必须是<code>/a/public</code>目录中的资源路径 即以<code>a代替了public</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/a/&#x27;</span>,express.<span class="title function_">static</span>(<span class="string">&#x27;./public/&#x27;</span>));</span><br></pre></td></tr></table></figure><p>如果没有第一个参数，则可以通过省略<code>/public</code>的方式来访问其中资源 即直接输入其中文件路径名就可以访问 不能添加public</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">static</span>(<span class="string">&#x27;./public/&#x27;</span>));</span><br></pre></td></tr></table></figure><h4 id="express中模板引擎的使用"><a href="#express中模板引擎的使用" class="headerlink" title="express中模板引擎的使用"></a>express中模板引擎的使用</h4><ol><li><p>安装模块</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install --save art-template </span><br><span class="line">npm install --save express-art-template</span><br></pre></td></tr></table></figure></li><li><p>配置(配置该选项之后<code>res.render</code>方法就可以用了)</p><p><code>server.engine(ext，回调)</code>: 将给定的模板引擎注册callback为ext。</p><p><code>server.engine(模板文件后缀名，加载express-art--template包)</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> server = <span class="title function_">express</span>(); </span><br><span class="line">server.<span class="title function_">engine</span>(<span class="string">&#x27;html&#x27;</span>,<span class="built_in">require</span>(<span class="string">&#x27;express-art-template&#x27;</span>));</span><br></pre></td></tr></table></figure></li><li><p>渲染</p><p><code>res.render(&#39;模板名&#39;,数据对象)</code>: 渲染模板并发送</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">server.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>,<span class="keyword">function</span>(<span class="params">req,res</span>) &#123; </span><br><span class="line">    res.<span class="title function_">render</span>(<span class="string">&#x27;index.html&#x27;</span>,&#123;<span class="attr">comments</span>:comments&#125;);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>注意: 第一个参数不能写路径 应该直接写文件名 默认会去项目中的views目录中查找 文件名必须以配置时第一个参数为后缀</p></li></ol><h4 id="express中的重定向"><a href="#express中的重定向" class="headerlink" title="express中的重定向"></a>express中的重定向</h4><p><code>res.redirect(路径)</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">server.<span class="title function_">get</span>(<span class="string">&#x27;/pinglun&#x27;</span>,<span class="keyword">function</span>(<span class="params">req,res</span>) &#123; </span><br><span class="line">    req.<span class="property">query</span>.<span class="property">dateTime</span> = <span class="string">&#x27;2019-10-29&#x27;</span>;</span><br><span class="line">    comments.<span class="title function_">unshift</span>(req.<span class="property">query</span>); </span><br><span class="line">    res.<span class="title function_">redirect</span>(<span class="string">&#x27;/&#x27;</span>);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="express中的发送文件"><a href="#express中的发送文件" class="headerlink" title="express中的发送文件"></a>express中的发送文件</h4><p><code>res.sendFile(absolutePath)</code>: 路径必须为绝对路径</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">server.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>,<span class="keyword">function</span>(<span class="params">req,res</span>) &#123;</span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    res.<span class="title function_">sendfile</span>(<span class="string">&#x27;public/index1.html&#x27;</span>); </span><br><span class="line">    </span><br><span class="line">	<span class="comment">//等同于效果</span></span><br><span class="line">	res.<span class="title function_">sendFile</span>(path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;../public&#x27;</span>, <span class="string">&#x27;index1.html&#x27;</span>));</span><br><span class="line"></span><br><span class="line">	<span class="comment">//第三种写法</span></span><br><span class="line">	res.<span class="title function_">sendFile</span>(<span class="string">&#x27;index1.html&#x27;</span>, &#123; <span class="attr">root</span>: path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;../public&#x27;</span>) &#125;);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="express中读取post主体-req-query只能获取get方式的数据"><a href="#express中读取post主体-req-query只能获取get方式的数据" class="headerlink" title="express中读取post主体(req.query只能获取get方式的数据)"></a>express中读取post主体(req.query只能获取get方式的数据)</h4><ol><li><p>安装</p><p>下载<code>body-parser</code>中间件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install body-parser</span><br></pre></td></tr></table></figure></li><li><p>加载</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> bodyparser = <span class="built_in">require</span>(<span class="string">&#x27;body-parser&#x27;</span>)</span><br></pre></td></tr></table></figure></li><li><p>配置</p><p>接收两种格式的数据</p><p><code>app.use(bodyparser.urlencoded())</code></p><p><code>app.use(bodyparser.json())</code></p></li><li><p>使用</p><p>在路由中用res的属性body获取即可(返回对象)</p><p><code>res.body</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/pinglun&#x27;</span>,<span class="keyword">function</span>(<span class="params">req,res</span>)&#123; </span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(res.<span class="property">body</span>);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li></ol><h4 id="express中的router中间件"><a href="#express中的router中间件" class="headerlink" title="express中的router中间件"></a>express中的router中间件</h4><p>在express中可以通过express最高级对象的<code>Router方法</code>生成一个router对象，router对象是一个隔离的中间价，不属于任何http对象，可以对其进行路由配置(get&#x2F;post等)。可以通过<code>app.use(router对象)</code>将其作为一个应用赋予http对象</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>); </span><br><span class="line"><span class="keyword">var</span> router = express.<span class="title class_">Router</span>(); </span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/students/new&#x27;</span>,<span class="keyword">function</span>(<span class="params">req,res</span>) &#123;</span><br><span class="line">    res.<span class="title function_">render</span>(<span class="string">&#x27;new.html&#x27;</span>);</span><br><span class="line">&#125;) </span><br><span class="line">app.<span class="title function_">use</span>(router);</span><br></pre></td></tr></table></figure><p>该特性可以让我们进行模块化开发，将入口文件和路由文件分开，路由文件将创建好的router对象通过exports.module导出，入口文件加载路有文件获取并使用use函数即可</p><h4 id="express中的session中间件"><a href="#express中的session中间件" class="headerlink" title="express中的session中间件"></a>express中的session中间件</h4><p>session就是会话<strong>，</strong>会话是一个比连接粒度更大的概念<strong>，</strong>一次会话可能包含多次连接，每次连接都被认为是会话的一次操作。</p><p>session 的技术实现上: 会对每一次对话产生一个唯一的标识id进行标识。将数据存在该id下就可以实现状态的保存</p><p>session生命周期: 当用户在Web页面之间跳转时，存储在 Session 对象中的变量将不会丢失，而是在整个用户会话中一直存在下去，如果会话关掉(客户端关掉)，那么就消失</p><p>当用户请求来自应用程序的 Web 页面时，如果该用户还没有会话，则 Web 服务器将自动创建一个 Session 对象。当会话过期或被放弃后，服务器将终止该会话。在Exrpess中，默认不支持Session和Cookie，可以使用第三方中间件: express-session来解决</p><p>步骤:</p><ol><li><p>安装</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install express-session</span><br></pre></td></tr></table></figure></li><li><p>配置 一定要在app.use(router)之前</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">use</span>(<span class="title function_">session</span>(&#123; </span><br><span class="line">    <span class="attr">secret</span>:<span class="string">&#x27;keyboard cat&#x27;</span>, <span class="comment">//配置加密字符串，会在原有加密基础上和这个字符串拼接起来加密，增加安全性 </span></span><br><span class="line">    <span class="attr">resave</span>:<span class="literal">false</span>, </span><br><span class="line">    <span class="attr">saveUninitialized</span>:<span class="literal">true</span> <span class="comment">//无论是否使用session都默认给客户端一把钥匙</span></span><br><span class="line">&#125;))</span><br></pre></td></tr></table></figure></li><li><p>使用</p><p>可以通过<code>req.session</code>来访问和设置Session数据</p><p>添加Session数据:<code>req.session.foo = &#39;bar&#39;</code></p><p>访问Session数据:<code>req.session.foo</code></p></li></ol><h3 id="插件说明"><a href="#插件说明" class="headerlink" title="插件说明"></a>插件说明</h3><blockquote><p>Nodemon插件: 可以自动重启服务器，不用每次修改js后手动重启</p></blockquote><p>安装：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-dev nodemon</span><br></pre></td></tr></table></figure><p>使用:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nodemon 文件.js</span><br></pre></td></tr></table></figure><h3 id="Node中使用MongoDB数据库"><a href="#Node中使用MongoDB数据库" class="headerlink" title="Node中使用MongoDB数据库"></a>Node中使用MongoDB数据库</h3><blockquote><p>可以使用官方的mongdb包来操作，也可以使用第三方mongoose包</p></blockquote><h4 id="MongoDB的数据结构"><a href="#MongoDB的数据结构" class="headerlink" title="MongoDB的数据结构"></a>MongoDB的数据结构</h4><p>可以如下面理解:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">一个数据库test:&#123;</span><br><span class="line"></span><br><span class="line">	test里的一个集合:cat&#123;</span><br><span class="line"></span><br><span class="line">		cat集合里的一条文档:&#123;name: &#x27;Zildjian&#x27;&#125;;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>下面以mongoose为例</p><h4 id="创建集合"><a href="#创建集合" class="headerlink" title="创建集合"></a>创建集合</h4><ol><li><p>加载包</p><p><code>变量名 = require(&#39;mongoose&#39;);</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> mongoose = <span class="built_in">require</span>(<span class="string">&#x27;mongoose&#x27;</span>);</span><br></pre></td></tr></table></figure></li><li><p>连接到一个数据库</p><p><code>mongoose.connect(mongodb://域名/数据库名)</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mongoose.<span class="title function_">connect</span>(<span class="string">&#x27;mongodb://localhost/zykj&#x27;</span>);</span><br></pre></td></tr></table></figure></li><li><p>设计集合结构</p><ul><li><p>获取一个Schema构造函数用以创建结构对象</p><p><code>变量名 = mongoose.Schema</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="title class_">Schema</span> = mongoose.<span class="property">Schema</span>;</span><br></pre></td></tr></table></figure></li><li><p>构造结构</p><p><code>var 结构名 = new Schema(文档结构)</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> blogSchema = <span class="keyword">new</span> <span class="title class_">Schema</span>(&#123; <span class="attr">title</span>: <span class="title class_">String</span>, <span class="attr">author</span>:<span class="title class_">String</span>, <span class="attr">body</span>:<span class="title class_">String</span> &#125;)</span><br></pre></td></tr></table></figure><p>即创建了一个名为blogSchema的文档结构</p></li></ul></li><li><p>发布模型(创建一个集合对象)</p><p><code>mongoose.model</code>: 将一个架构发布为model 也就是创建了一个集合，<code>第一个参数为集合的名字</code>,<code>第二个参数为这个新建集合存储的文档的格式(大写会转为小写，在后面会加s) 返回一个构造函数</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="title class_">User</span> = mongoose.<span class="title function_">model</span>(<span class="string">&#x27;User&#x27;</span>,blogSchema);</span><br></pre></td></tr></table></figure><p>返回一个构造函数用以创建新文档，此时数据库中已有名为users的集合，该集合的文档结构就是blogSchema的对象的结构，但还没有数据</p></li></ol><h4 id="数据操作"><a href="#数据操作" class="headerlink" title="数据操作"></a>数据操作</h4><ol><li><p>新增数据</p><p>new创建一个模型的实例对象即可，数据结构按照设置好的Schema模板来</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> art1 = <span class="keyword">new</span> <span class="title class_">User</span>(&#123; <span class="attr">title</span>:<span class="string">&#x27;how to kill you&#x27;</span>, <span class="attr">author</span>:<span class="string">&#x27;bruce chen&#x27;</span>, <span class="attr">body</span>:<span class="string">&#x27;just use fucking pencil!&#x27;</span> &#125;)</span><br></pre></td></tr></table></figure><p>持久化存储: 将创建好的User对象调用<code>save</code>方法即可 可传入回调函数</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">art1.<span class="title function_">save</span>(<span class="keyword">function</span>(<span class="params">err</span>) &#123; 	</span><br><span class="line">    <span class="keyword">if</span>(err) &#123; 		</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(err);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123; </span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;保存成功!&#x27;</span>); </span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li><li><p>查询数据</p><ul><li><p>查询全部</p><p>调用模型对象的<code>find</code>方法: 参数为回调函数,函数的参数<code>第一个是错误对象</code>,<code>第二个查询结果</code> 结果都包裹在数组中</p><p><code>User.find(function(err,data)&#123;&#125;)</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">User</span>.<span class="title function_">find</span>(<span class="keyword">function</span>(<span class="params">err,data</span>) &#123; </span><br><span class="line">    <span class="keyword">if</span>(err) &#123; </span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(err);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(data);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li><li><p>按条件查询</p><p>依旧是find方法:<code>第一个参数是数组形式的查询条件</code>,<code>第二个为查询完成后的回调函数,返回数组形式</code>,返回多个符合条件的文档</p><p><code>User.find(&#123;条件&#125;,function(err,data)&#123;&#125;)</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">User</span>.<span class="title function_">find</span>(&#123;<span class="attr">author</span>:<span class="string">&#x27;bruce huang&#x27;</span>&#125;,<span class="keyword">function</span>(<span class="params">err,data</span>) &#123; </span><br><span class="line">    <span class="keyword">if</span>(err) &#123; </span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(err);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123; </span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(data);</span><br><span class="line">    &#125; </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li><li><p>查找符合条件的第一个</p><p><code>findOne方法</code>:按照条件查找第一个符合条件的文档 返回对象形式</p><p><code>User.findOne(&#123;条件&#125;,function(err,data)&#123;&#125;)</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">User</span>.<span class="title function_">findOne</span>(&#123;<span class="attr">author</span>:<span class="string">&#x27;bruce huang&#x27;</span>&#125;,<span class="keyword">function</span>(<span class="params">err,data</span>) &#123; </span><br><span class="line">    <span class="keyword">if</span>(err) &#123; 	</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(err);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123; 	</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(data);</span><br><span class="line">    &#125; </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>注意: 用find方法查找数据时，即使数据为空，也会返回一个空数组，所以判定应当判定长度而不是变量</p></li></ul></li><li><p>删除数据</p><p>利用模型的remove方法</p><p><code>User.remove(条件,回调函数(错误对象，返回结果))</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">User</span>.<span class="title function_">remove</span>(&#123;<span class="attr">author</span>:<span class="string">&#x27;bruce huang&#x27;</span>&#125;,<span class="keyword">function</span>(<span class="params">err,data</span>) &#123; </span><br><span class="line">    <span class="keyword">if</span>(err) &#123; </span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(err);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123; </span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(data); </span><br><span class="line">    &#125; </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li><li><p>更改数据</p><p>利用模型对象的</p><p><code>User.findByIdAndUpdate(id值，修改的值(对象形式),回调函数)</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">User</span>.<span class="title function_">findByIdAndUpdate</span>(<span class="string">&#x27;5dc5583de916d516a8577746&#x27;</span>,&#123;<span class="string">&#x27;body&#x27;</span>:<span class="string">&#x27;not pencil&#x27;</span>&#125;,<span class="keyword">function</span>(<span class="params">err,data</span>) &#123; </span><br><span class="line">    <span class="keyword">if</span>(err) &#123; </span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(err); </span><br><span class="line">    &#125; <span class="keyword">else</span> &#123; 	</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(data); </span><br><span class="line">    &#125; </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>注意: 当用数据库读取到的_id数据渲染页面时，页面中应该写成id，不要写_id</p></li><li><p>分段读取数据</p><p><code>mongoose.find().skip(n).limit(n).exec((err,data) =&gt; &#123;&#125;)</code></p><ul><li><p><code>skip(n)</code>: 代表跳过n条数据</p></li><li><p><code>limit(n)</code>: 代表只读取n条数据</p></li><li><p>exec回调函数的第二个参数data代表读取到的内容</p></li></ul><p>一般用于页面分页的处理，可以配合<code>twb-pagination</code>使用</p></li></ol><h4 id="关于异步编程-回调地狱、promise"><a href="#关于异步编程-回调地狱、promise" class="headerlink" title="关于异步编程(回调地狱、promise)"></a>关于异步编程(回调地狱、promise)</h4><blockquote><p>什么是回调地狱？</p><p>当有多个异步事件时，其输出结果顺序是不定的，一般取决于文件大小。如下面代码</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">fs.<span class="title function_">readFile</span>(<span class="string">&#x27;./data/a.txt&#x27;</span>,<span class="string">&#x27;utf8&#x27;</span>,<span class="keyword">function</span>(<span class="params">err,data</span>) &#123; </span><br><span class="line">    <span class="keyword">if</span>(err) &#123; </span><br><span class="line">        <span class="comment">// return </span></span><br><span class="line">        res.<span class="title function_">end</span>(<span class="string">&#x27;failed&#x27;</span>); 	</span><br><span class="line">        <span class="keyword">throw</span> err; </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(data);</span><br><span class="line">&#125;) </span><br><span class="line"></span><br><span class="line">fs.<span class="title function_">readFile</span>(<span class="string">&#x27;./data/b.txt&#x27;</span>,<span class="string">&#x27;utf8&#x27;</span>,<span class="keyword">function</span>(<span class="params">err,data</span>) &#123; </span><br><span class="line">    <span class="keyword">if</span>(err) &#123; </span><br><span class="line">        <span class="comment">// return </span></span><br><span class="line">        res.<span class="title function_">end</span>(<span class="string">&#x27;failed&#x27;</span>); </span><br><span class="line">        <span class="keyword">throw</span> err;</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(data);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>所以为了让事件按照我们想要的顺序生成结果，我们可以将后执行的事件嵌入先执行的事件的回调函数里，如下面代码</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">fs.<span class="title function_">readFile</span>(<span class="string">&#x27;./data/c.txt&#x27;</span>,<span class="string">&#x27;utf8&#x27;</span>,<span class="keyword">function</span>(<span class="params">err,data</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span>(err) &#123; </span><br><span class="line">        <span class="comment">// return </span></span><br><span class="line">        res.<span class="title function_">end</span>(<span class="string">&#x27;failed&#x27;</span>);</span><br><span class="line">        <span class="keyword">throw</span> err;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(data);</span><br><span class="line">    fs.<span class="title function_">readFile</span>(<span class="string">&#x27;./data/b.txt&#x27;</span>,<span class="string">&#x27;utf8&#x27;</span>,<span class="keyword">function</span>(<span class="params">err,data</span>) &#123; </span><br><span class="line">        <span class="keyword">if</span>(err) &#123; </span><br><span class="line">            <span class="comment">// return </span></span><br><span class="line">            res.<span class="title function_">end</span>(<span class="string">&#x27;failed&#x27;</span>); </span><br><span class="line">            <span class="keyword">throw</span> err; </span><br><span class="line">        &#125; </span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(data) </span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>但是如果事件太多，那么代码就会太冗长，难以维护，形成了回调地狱</p><p>解决这个问题，我们可以使用ES6新增语法<code>Promise</code></p><h3 id="表单的同步提交-默认-和异步提交-ajax"><a href="#表单的同步提交-默认-和异步提交-ajax" class="headerlink" title="表单的同步提交(默认)和异步提交(ajax)"></a>表单的同步提交(默认)和异步提交(ajax)</h3><p>表单具有默认的提交行为，默认是同步的，同步表单提交，浏览器会锁死(转圈儿)等待服务端的响应结果。表单的同步提交之后，无论服务端响应的是什么，都会直接把响应的结果覆盖掉当前页面。</p><p>后来有人想到了一种办法，来解决这个问题。即提交表达后在服务器重定位到相同的页面，通过模板引擎将要提示的信息渲染到页面上(现在仍有网站使用这种方式)</p><p>再后来出现了ajax，实现不用刷新页面也能获取服务器发送的数据的效果</p><h3 id="Node中Babel转码器的部署"><a href="#Node中Babel转码器的部署" class="headerlink" title="Node中Babel转码器的部署"></a>Node中Babel转码器的部署</h3><p>虽然现在浏览器对ES6的支持性普遍很好，但是考虑到一些旧版浏览器用户以及我们可能会想通过es6模块语法实现模块化开发，所以我们需要babel转码器将我们写的es6代码转为浏览器普遍支持的代码以便于开发和上线</p><h4 id="部署Babel的第一步"><a href="#部署Babel的第一步" class="headerlink" title="部署Babel的第一步"></a>部署Babel的第一步</h4><p>Babel 的配置文件是<code>.babelrc</code>，存放在项目的根目录下。使用 Babel 的第一步，就是配置这个文件。</p><p>该文件用来设置转码规则和插件，基本格式如下:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;    </span><br><span class="line">    &quot;present&quot;:[    </span><br><span class="line">        &quot;@babel/env&quot;,     </span><br><span class="line">        &quot;@babel/preset-react&quot;  </span><br><span class="line">    ],   </span><br><span class="line">    &quot;plugins&quot;:[]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>其中<code>present字段</code>设定转码规则，可以通过以下代码下载转码规则:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 最新转码规则</span></span><br><span class="line">npm install --save-dev @babel/preset-env </span><br><span class="line"></span><br><span class="line"><span class="comment">## react 转码规则 </span></span><br><span class="line">npm install --save-dev @babel/preset-react</span><br></pre></td></tr></table></figure><p><code>dev的含义</code>: 代表这个包是开发临时使用，保存到 <code>package.json</code> 文件中的 <code>devDependencies</code> 选项中。</p><p>注意: <code>.babelrc</code>文件的配置必不可少</p><h4 id="babel-x2F-regitser模块"><a href="#babel-x2F-regitser模块" class="headerlink" title="@babel&#x2F;regitser模块"></a>@babel&#x2F;regitser模块</h4><p>开发的过程中，需要不断的调试，为了方便，我们需要能实时转码的工具，即每次调用都不需要一个文件一个文件的转码，可以用<code>@babel/regitser</code>模块</p><p>使用方法:</p><ol><li><p>先安装该模块</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-dev @babel/register</span><br></pre></td></tr></table></figure></li><li><p>设立一个入口文件，该文件用于载入<code>babel/register</code>模块并将其中require的js文件进行实时转码</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// index.js </span></span><br><span class="line"><span class="built_in">require</span>(<span class="string">&#x27;@babel/register&#x27;</span>); </span><br><span class="line"><span class="built_in">require</span>(<span class="string">&#x27;./es6.js&#x27;</span>);</span><br></pre></td></tr></table></figure><p>注意: 必须<code>先引入模块</code>再<code>引入要实时转码的文件</code></p></li><li><p>每当调试时，运行该入口文件即可</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node index.js</span><br></pre></td></tr></table></figure><p>注意: 该模块只用适合在开发环境使用，用于开发调试时将源代码转换。因为是实时的，如果用于上线后，会影响网站性能</p></li></ol><h4 id="babel-x2F-cli"><a href="#babel-x2F-cli" class="headerlink" title="@babel&#x2F;cli"></a>@babel&#x2F;cli</h4><p>当完成开发后，我们需要将写好的代码完全转码成新的文件用于线上环境，<code>babel/cli</code>工具可以帮助完成。</p><p>这个模块用于命令行中转码使用，可以<code>将js文件代码转码输出到命令行中</code>也可以<code>转码输出到新的文件里</code>，还可以<code>转码整个目录的文件到另一个目录</code></p><p>使用方法:</p><ol><li><p>安装</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-dev @babel/cli</span><br></pre></td></tr></table></figure></li><li><p>使用</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 转码结果输出到标准输出 </span></span><br><span class="line">npx babel example.js </span><br><span class="line"></span><br><span class="line"><span class="comment">## 转码结果写入一个文件 </span></span><br><span class="line"><span class="comment">## --out-file 或 -o 参数指定输出文件 </span></span><br><span class="line">npx babel example.js --out-file compiled.js </span><br><span class="line"><span class="comment">## 或者 </span></span><br><span class="line">npx babel example.js -o compiled.js </span><br><span class="line"></span><br><span class="line"><span class="comment">## 整个目录转码 </span></span><br><span class="line"><span class="comment">## --out-dir 或 -d 参数指定输出目录 </span></span><br><span class="line">npx babel src --out-dir lib </span><br><span class="line"><span class="comment">## 或者 </span></span><br><span class="line">npx babel src -d lib</span><br></pre></td></tr></table></figure><p>所以可以使用<code>babel src -d lib</code>将src目录下的代码转码生成同名文件并放到lib文件夹中。</p><p>注意: src是我们开发时写的代码，有es6语法。lib是上线时使用的代码，无es6语法</p></li></ol><h4 id="packagejson文件中script字段用法"><a href="#packagejson文件中script字段用法" class="headerlink" title="packagejson文件中script字段用法"></a>packagejson文件中script字段用法</h4><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span>  </span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;babel-demo&quot;</span><span class="punctuation">,</span>  </span><br><span class="line">    <span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span>   </span><br><span class="line">        <span class="attr">&quot;test&quot;</span><span class="punctuation">:</span> <span class="string">&quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span><span class="punctuation">,</span>  </span><br><span class="line">        <span class="attr">&quot;build&quot;</span><span class="punctuation">:</span> <span class="string">&quot;babel demo1.js&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;dev&quot;</span><span class="punctuation">:</span> <span class="string">&quot;node main.js&quot;</span><span class="punctuation">,</span> </span><br><span class="line">        <span class="attr">&quot;prestart&quot;</span><span class="punctuation">:</span> <span class="string">&quot;npm run build&quot;</span><span class="punctuation">,</span>   </span><br><span class="line">        <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="string">&quot;node dist/app.js&quot;</span>  </span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span>  </span><br><span class="line">    <span class="attr">&quot;devDependencies&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span>  </span><br><span class="line">        <span class="attr">&quot;babel-cli&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^6.22.2&quot;</span><span class="punctuation">,</span>   </span><br><span class="line">        <span class="attr">&quot;babel-preset-es2015&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^6.22.0&quot;</span><span class="punctuation">,</span>  </span><br><span class="line">        <span class="attr">&quot;babel-preset-react&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^6.22.0&quot;</span> </span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p><code>script字段</code>用于设置快捷命令执行，即可以通过指定的新命令来执行某些命令</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">script:&#123;   </span><br><span class="line">	命令名: &quot;被代替的命令&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>命令名可以随意起(<code>除了start和prestart</code>)，执行方式为<code>npm run 命令名</code></p><p>比如可以将调试时执行入口函数的命令其名为’dev’</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;build&quot;: &quot;babel demo1.js&quot;，</span><br></pre></td></tr></table></figure><p><code>start命令</code>用于执行上线时所使用的入口函数，<code>prestart的命令</code>会在执行start前自动执行，所以可以用来执行<code>babel/cli</code>工具先将源代码转为上线时所用代码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&quot;prestart&quot;: &quot;babel src -d dist&quot;,   </span><br><span class="line">&quot;start&quot;: &quot;node dist/app.js&quot;</span><br></pre></td></tr></table></figure><p>所以只要将<code>babel/cli</code>安装在项目中并且<code>babel src -d lib</code>写入<code>script的prestart字段</code>就可以保证每次执行<code>npm run start</code>前都会被转码</p><h3 id="项目的模块化"><a href="#项目的模块化" class="headerlink" title="项目的模块化"></a>项目的模块化</h3><ol><li><p><code>dist文件</code>: 用于存放转码后的源代码，用于上线</p></li><li><p><code>src文件</code>: 用于存放开发过程中的源代码，一般还可以根据不同业务分为不同的文件夹，如路由文件夹、中间件文件夹、数据处理函数文件夹、数据库模型文件夹</p></li><li><p><code>views文件夹</code>: 用于存放页面文件，根据页面不同分成多个子文件夹</p></li><li><p><code>public文件夹</code>: 存放公共文件的文件夹，比如图片、css文件、js文件等</p></li></ol><h3 id="NVM"><a href="#NVM" class="headerlink" title="NVM"></a>NVM</h3><blockquote><p>(Node Version Management)node版本管理工具</p></blockquote><ul><li><p><code>nvm list</code>: 查看所有已安装的 node 版本</p></li><li><p><code>nvm install 版本号</code>: 安装指定版本的 node</p></li><li><p><code>nvm use 版本号</code>: 切换到指定版本号</p></li><li><p><code>nvm proxy 代理地址</code>: 配置代理进行下载</p></li></ul></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者:</span> <span class="post-copyright-info"><a href="https://zykj.js.org">ZYKJ</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接:</span> <span class="post-copyright-info"><a href="https://zykj.js.org/posts/d8fc8ff1/">https://zykj.js.org/posts/d8fc8ff1/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明:</span> <span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noreferrer" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://zykj.js.org" target="_blank">ZYKJ's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%89%8D%E7%AB%AF/">前端</a><a class="post-meta__tags" href="/tags/Nodejs/">Nodejs</a></div><div class="post_share"><div class="social-share" data-image="https://gcore.jsdelivr.net/gh/zykjofficial/zykjimg/img/nodejsstudy-cover.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://gcore.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://gcore.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://gcore.jsdelivr.net/gh/zykjofficial/zykjimg/img/alipay.png" rel="external nofollow noreferrer" target="_blank"><img class="post-qr-code-img" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/zykjofficial/zykjimg/img/alipay.png" alt="支付宝"></a><div class="post-qr-code-desc">支付宝</div></li><li class="reward-item"><a href="https://gcore.jsdelivr.net/gh/zykjofficial/zykjimg/img/wechat.png" rel="external nofollow noreferrer" target="_blank"><img class="post-qr-code-img" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/zykjofficial/zykjimg/img/wechat.png" alt="微信"></a><div class="post-qr-code-desc">微信</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/581025ac/"><img class="prev-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/zykjofficial/zykjimg/img/neumorphism-cover.png" onerror='onerror=null,src="https://gcore.jsdelivr.net/gh/zykjofficial/zykjofficial.github.io@master/img/404.jpg"' alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">如何使用CSS或者Pr做出新拟态效果</div></div></a></div><div class="next-post pull-right"><a href="/posts/c747b178/"><img class="next-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/zykjofficial/zykjimg/img/ajaxstudy-cover.png" onerror='onerror=null,src="https://gcore.jsdelivr.net/gh/zykjofficial/zykjofficial.github.io@master/img/404.jpg"' alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">AJAX学习</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/posts/88130ada/" title="解决前端跨域问题"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/zykjofficial/zykjimg/img/cross-origin-cover.png" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2020-05-30</div><div class="title">解决前端跨域问题</div></div></a></div><div><a href="/posts/22686bb0/" title="Vue-CLI学习"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/zykjofficial/zykjimg/img/vueclistudy-cover.png" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2020-06-27</div><div class="title">Vue-CLI学习</div></div></a></div><div><a href="/posts/5650a45b/" title="Axios学习"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/zykjofficial/zykjimg/anime/Wallpaper01.png" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2020-07-12</div><div class="title">Axios学习</div></div></a></div></div></div><hr><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i> <span>评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Nodejs%E5%AD%A6%E4%B9%A0"><span class="toc-number">1.</span> <span class="toc-text">Nodejs学习</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Nodejs"><span class="toc-number">1.1.</span> <span class="toc-text">Nodejs</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFNode-js"><span class="toc-number">1.1.1.</span> <span class="toc-text">什么是Node.js</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Node-js%E5%8F%AF%E4%BB%A5%E5%81%9A%E4%BB%80%E4%B9%88"><span class="toc-number">1.1.2.</span> <span class="toc-text">Node.js可以做什么</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#npm"><span class="toc-number">1.1.3.</span> <span class="toc-text">npm</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E5%88%A9%E7%94%A8Node-js%E8%A7%A3%E6%9E%90js%E6%96%87%E4%BB%B6"><span class="toc-number">1.1.4.</span> <span class="toc-text">如何利用Node.js解析js文件</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E7%94%9FNode-js"><span class="toc-number">1.2.</span> <span class="toc-text">原生Node.js</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Node-js%E4%B8%AD%E7%9A%84JavaScript"><span class="toc-number">1.2.1.</span> <span class="toc-text">Node.js中的JavaScript</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%A8%A1%E5%9D%97%E7%9A%84%E5%8A%A0%E8%BD%BD"><span class="toc-number">1.2.1.1.</span> <span class="toc-text">模块的加载</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%A9%E7%94%A8require%E5%BC%95%E7%94%A8%E5%85%B6%E4%BB%96js%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%8F%98%E9%87%8F%E5%87%BD%E6%95%B0"><span class="toc-number">1.2.1.2.</span> <span class="toc-text">利用require引用其他js文件中的变量函数</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%A8%A1%E5%9D%97%E7%9A%84%E5%8A%A0%E8%BD%BD%E9%A1%BA%E5%BA%8F"><span class="toc-number">1.2.1.3.</span> <span class="toc-text">模块的加载顺序</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%89%E7%A7%8D%E6%A8%A1%E5%9D%97%E7%9A%84%E5%8A%A0%E8%BD%BD%E5%8E%9F%E7%90%86"><span class="toc-number">1.2.1.4.</span> <span class="toc-text">三种模块的加载原理</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#fs%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C%E6%A8%A1%E5%9D%97"><span class="toc-number">1.2.2.</span> <span class="toc-text">fs文件操作模块</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6"><span class="toc-number">1.2.2.1.</span> <span class="toc-text">读取文件</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%86%99%E5%85%A5%E6%96%87%E4%BB%B6"><span class="toc-number">1.2.2.2.</span> <span class="toc-text">写入文件</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%BF%BD%E5%8A%A0%E6%96%87%E4%BB%B6"><span class="toc-number">1.2.2.3.</span> <span class="toc-text">追加文件</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E6%96%87%E4%BB%B6"><span class="toc-number">1.2.2.4.</span> <span class="toc-text">删除文件</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E5%88%97%E8%A1%A8"><span class="toc-number">1.2.2.5.</span> <span class="toc-text">读取文件列表</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Http%E6%A8%A1%E5%9D%97"><span class="toc-number">1.2.3.</span> <span class="toc-text">Http模块</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%AD%A5%E9%AA%A4"><span class="toc-number">1.2.3.1.</span> <span class="toc-text">步骤</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#http%E7%9A%84%E9%87%8D%E5%AE%9A%E5%90%91"><span class="toc-number">1.2.3.2.</span> <span class="toc-text">http的重定向</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#URL%E6%A8%A1%E5%9D%97"><span class="toc-number">1.2.4.</span> <span class="toc-text">URL模块</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8A%A0%E8%BD%BD%E6%A8%A1%E5%9D%97"><span class="toc-number">1.2.4.1.</span> <span class="toc-text">加载模块</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%A7%A3%E6%9E%90%E5%9C%B0%E5%9D%80%E6%96%B9%E6%B3%95"><span class="toc-number">1.2.4.2.</span> <span class="toc-text">解析地址方法</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Path%E6%A8%A1%E5%9D%97"><span class="toc-number">1.2.5.</span> <span class="toc-text">Path模块</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8A%A0%E8%BD%BD%E6%96%B9%E5%BC%8F"><span class="toc-number">1.2.5.1.</span> <span class="toc-text">加载方式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%A8%A1%E5%9D%97%E6%96%B9%E6%B3%95"><span class="toc-number">1.2.5.2.</span> <span class="toc-text">模块方法</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Node%E4%B8%AD%E7%9A%84dirname%E5%92%8C-filename"><span class="toc-number">1.2.6.</span> <span class="toc-text">Node中的dirname和__filename</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#art-template%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E%E6%A8%A1%E5%9D%97"><span class="toc-number">1.2.7.</span> <span class="toc-text">art-template模板引擎模块</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#formidable%E6%A8%A1%E5%9D%97%E5%AE%9E%E7%8E%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0"><span class="toc-number">1.2.8.</span> <span class="toc-text">formidable模块实现文件上传</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%B2%E6%9F%93%E6%95%B0%E6%8D%AE%E5%92%8C%E6%9C%8D%E5%8A%A1%E7%AB%AF%E6%B8%B2%E6%9F%93%E6%95%B0%E6%8D%AE%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">1.2.9.</span> <span class="toc-text">客户端渲染数据和服务端渲染数据的区别</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#REPL-read-eval-print-loop"><span class="toc-number">1.3.</span> <span class="toc-text">REPL(read eval print loop)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Express%E6%A1%86%E6%9E%B6%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">1.4.</span> <span class="toc-text">Express框架的使用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#express%E7%9A%84%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A6%82%E5%BF%B5"><span class="toc-number">1.4.1.</span> <span class="toc-text">express的中间件概念</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#express%E5%BF%AB%E9%80%9F%E5%A4%84%E7%90%86%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90-%E4%BD%BF%E7%94%A8express-static%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="toc-number">1.4.2.</span> <span class="toc-text">express快速处理静态资源(使用express.static中间件)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#express%E4%B8%AD%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">1.4.3.</span> <span class="toc-text">express中模板引擎的使用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#express%E4%B8%AD%E7%9A%84%E9%87%8D%E5%AE%9A%E5%90%91"><span class="toc-number">1.4.4.</span> <span class="toc-text">express中的重定向</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#express%E4%B8%AD%E7%9A%84%E5%8F%91%E9%80%81%E6%96%87%E4%BB%B6"><span class="toc-number">1.4.5.</span> <span class="toc-text">express中的发送文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#express%E4%B8%AD%E8%AF%BB%E5%8F%96post%E4%B8%BB%E4%BD%93-req-query%E5%8F%AA%E8%83%BD%E8%8E%B7%E5%8F%96get%E6%96%B9%E5%BC%8F%E7%9A%84%E6%95%B0%E6%8D%AE"><span class="toc-number">1.4.6.</span> <span class="toc-text">express中读取post主体(req.query只能获取get方式的数据)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#express%E4%B8%AD%E7%9A%84router%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="toc-number">1.4.7.</span> <span class="toc-text">express中的router中间件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#express%E4%B8%AD%E7%9A%84session%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="toc-number">1.4.8.</span> <span class="toc-text">express中的session中间件</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8F%92%E4%BB%B6%E8%AF%B4%E6%98%8E"><span class="toc-number">1.5.</span> <span class="toc-text">插件说明</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Node%E4%B8%AD%E4%BD%BF%E7%94%A8MongoDB%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">1.6.</span> <span class="toc-text">Node中使用MongoDB数据库</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#MongoDB%E7%9A%84%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84"><span class="toc-number">1.6.1.</span> <span class="toc-text">MongoDB的数据结构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E9%9B%86%E5%90%88"><span class="toc-number">1.6.2.</span> <span class="toc-text">创建集合</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%93%8D%E4%BD%9C"><span class="toc-number">1.6.3.</span> <span class="toc-text">数据操作</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%B3%E4%BA%8E%E5%BC%82%E6%AD%A5%E7%BC%96%E7%A8%8B-%E5%9B%9E%E8%B0%83%E5%9C%B0%E7%8B%B1%E3%80%81promise"><span class="toc-number">1.6.4.</span> <span class="toc-text">关于异步编程(回调地狱、promise)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A1%A8%E5%8D%95%E7%9A%84%E5%90%8C%E6%AD%A5%E6%8F%90%E4%BA%A4-%E9%BB%98%E8%AE%A4-%E5%92%8C%E5%BC%82%E6%AD%A5%E6%8F%90%E4%BA%A4-ajax"><span class="toc-number">1.7.</span> <span class="toc-text">表单的同步提交(默认)和异步提交(ajax)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Node%E4%B8%ADBabel%E8%BD%AC%E7%A0%81%E5%99%A8%E7%9A%84%E9%83%A8%E7%BD%B2"><span class="toc-number">1.8.</span> <span class="toc-text">Node中Babel转码器的部署</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%83%A8%E7%BD%B2Babel%E7%9A%84%E7%AC%AC%E4%B8%80%E6%AD%A5"><span class="toc-number">1.8.1.</span> <span class="toc-text">部署Babel的第一步</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#babel-x2F-regitser%E6%A8%A1%E5%9D%97"><span class="toc-number">1.8.2.</span> <span class="toc-text">@babel&#x2F;regitser模块</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#babel-x2F-cli"><span class="toc-number">1.8.3.</span> <span class="toc-text">@babel&#x2F;cli</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#packagejson%E6%96%87%E4%BB%B6%E4%B8%ADscript%E5%AD%97%E6%AE%B5%E7%94%A8%E6%B3%95"><span class="toc-number">1.8.4.</span> <span class="toc-text">packagejson文件中script字段用法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E7%9A%84%E6%A8%A1%E5%9D%97%E5%8C%96"><span class="toc-number">1.9.</span> <span class="toc-text">项目的模块化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NVM"><span class="toc-number">1.10.</span> <span class="toc-text">NVM</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer" style="background-image:url(https://gcore.jsdelivr.net/gh/zykjofficial/zykjimg/img/nodejsstudy-cover.png)"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By ZYKJ</div><div class="framework-info"><span>框架</span> <a target="_blank" rel="noopener external nofollow noreferrer" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题</span> <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">CDN BY <a target="_blank" href="https://www.jsdelivr.com/" rel="external nofollow noreferrer" data-pjax-state=""><b>jsDelivr</b></a> | HOST BY <a target="_blank" href="https://vercel.com/" rel="external nofollow noreferrer"><b>Vercel</b></a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i> <span>数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"></div></div><hr><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="https://gcore.jsdelivr.net/gh/zykjofficial/zykjofficial.github.io@master/js/utils.js"></script><script src="https://gcore.jsdelivr.net/gh/zykjofficial/zykjofficial.github.io@master/js/main.js"></script><script src="https://gcore.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://gcore.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://gcore.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://gcore.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>function panguFn(){"object"==typeof pangu?pangu.autoSpacingPage():getScript("https://gcore.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js").then(()=>{pangu.autoSpacingPage()})}function panguInit(){GLOBAL_CONFIG_SITE.isPost&&panguFn()}document.addEventListener("DOMContentLoaded",panguInit)</script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>(()=>{const o=()=>{twikoo.init(Object.assign({el:"#twikoo-wrap",envId:"twikoo-4g2ypman52a24a4b",region:"",onCommentLoaded:function(){btf.loadLightbox(document.querySelectorAll("#twikoo .tk-content img:not(.tk-owo-emotion)"))}},null)),GLOBAL_CONFIG_SITE.isPost&&(()=>{const o=document.getElementById("twikoo-count");o&&twikoo.getCommentsCount({envId:"twikoo-4g2ypman52a24a4b",region:"",urls:[window.location.pathname],includeReply:!1}).then((function(t){o.innerText=t[0].count})).catch((function(o){console.error(o)}))})()},t=()=>{"object"!=typeof twikoo?getScript("https://gcore.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js").then(o):setTimeout(o,0)};btf.loadComment(document.getElementById("twikoo-wrap"),t)})()</script></div><script>window.addEventListener("load",()=>{const e=e=>{let t="";if(e.length)for(let n=0;n<e.length;n++)t+="<div class='aside-list-item'>",t+=`<div class='content'>\n        <a class='comment' href='${e[n].url}' title='${e[n].content}'>${e[n].content}</a>\n        <div class='name'><span>${e[n].nick} / </span><time datetime="${e[n].date}">${btf.diffDate(e[n].date,!0)}</time></div>\n        </div></div>`;else t+="没有评论";let n=document.querySelector("#card-newest-comments .aside-list");n.innerHTML=t,window.lazyLoadInstance&&window.lazyLoadInstance.update(),window.pjax&&window.pjax.refresh(n)},t=()=>{if(document.querySelector("#card-newest-comments .aside-list")){const t=saveToLocal.get("twikoo-newest-comments");t?e(JSON.parse(t)):(()=>{const t=()=>{twikoo.getRecentComments({envId:"twikoo-4g2ypman52a24a4b",region:"",pageSize:3,includeReply:!0}).then((function(t){const n=t.map(e=>{return{content:(t=e.comment,""===t||(t=(t=(t=(t=t.replace(/<img.*?src="(.*?)"?[^\>]+>/gi,"[图片]")).replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi,"[链接]")).replace(/<pre><code>.*?<\/pre>/gi,"[代码]")).replace(/<[^>]+>/g,"")).length>150&&(t=t.substring(0,150)+"..."),t),avatar:e.avatar,nick:e.nick,url:e.url+"#"+e.id,date:new Date(e.created).toISOString()};var t});saveToLocal.set("twikoo-newest-comments",JSON.stringify(n),10/1440),e(n)})).catch((function(e){document.querySelector("#card-newest-comments .aside-list").innerHTML="无法获取评论，请确认相关配置是否正确"}))};"object"==typeof twikoo?t():getScript("https://gcore.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js").then(t)})()}};t(),document.addEventListener("pjax:complete",t)})</script><div class="app-refresh" id="app-refresh"><div class="app-refresh-wrap"><label>🚀 网站已更新最新版本 📑</label> <a href="javascript:void(0)" rel="external nofollow noreferrer" onclick="location.reload()">点我更新</a></div></div><script>function showNotification(){if(GLOBAL_CONFIG.Snackbar){var t="light"===document.documentElement.getAttribute("data-theme")?GLOBAL_CONFIG.Snackbar.bgLight:GLOBAL_CONFIG.Snackbar.bgDark,e=GLOBAL_CONFIG.Snackbar.position;Snackbar.show({text:"🚀 博客已更新最新版本 🌍",backgroundColor:t,duration:5e5,pos:e,actionText:"点我更新⚡",actionTextColor:"#fff",onActionClick:function(t){location.reload()}})}else{var o=`top: 0; background: ${"light"===document.documentElement.getAttribute("data-theme")?"#49b1f5":"#1f1f1f"};`;document.getElementById("app-refresh").style.cssText=o}}"serviceWorker"in navigator&&(navigator.serviceWorker.controller&&navigator.serviceWorker.addEventListener("controllerchange",(function(){showNotification()})),window.addEventListener("load",(function(){navigator.serviceWorker.register("/sw.js")})))</script><script src="https://gcore.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors=["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"];var pjax=new Pjax({elements:'a:not([target="_blank"]):not([href="/link/"]):not([href="/catchcat/"]):not([href="/shuoshuo/"]):not([href="/friendcircle/"]):not([href="/about/"]):not([href="/me/"]):not([href="/posts/e297feab/"])',selectors:pjaxSelectors,cacheBust:!1,analytics:!1,scrollRestoration:!1});document.addEventListener("pjax:send",(function(){if(window.tocScrollFn&&window.removeEventListener("scroll",window.tocScrollFn),window.scrollCollect&&window.removeEventListener("scroll",scrollCollect),"object"==typeof preloader&&preloader.initLoading(),document.getElementById("rightside").style.cssText="opacity: ''; transform: ''",window.aplayers)for(let e=0;e<window.aplayers.length;e++)window.aplayers[e].options.fixed||window.aplayers[e].destroy();"object"==typeof typed&&typed.destroy();const e=document.body.classList;e.contains("read-mode")&&e.remove("read-mode"),"object"==typeof disqusjs&&disqusjs.destroy()})),document.addEventListener("pjax:complete",(function(){window.refreshFn(),document.querySelectorAll("script[data-pjax]").forEach(e=>{const t=document.createElement("script"),o=e.text||e.textContent||e.innerHTML||"";Array.from(e.attributes).forEach(e=>t.setAttribute(e.name,e.value)),t.appendChild(document.createTextNode(o)),e.parentNode.replaceChild(t,e)}),GLOBAL_CONFIG.islazyload&&window.lazyLoadInstance.update(),"function"==typeof chatBtnFn&&chatBtnFn(),"function"==typeof panguInit&&panguInit(),"function"==typeof gtag&&gtag("config","",{page_path:window.location.pathname}),"object"==typeof _hmt&&_hmt.push(["_trackPageview",window.location.pathname]),"function"==typeof loadMeting&&document.getElementsByClassName("aplayer").length&&loadMeting(),"object"==typeof Prism&&Prism.highlightAll(),"object"==typeof preloader&&preloader.endLoading()})),document.addEventListener("pjax:error",e=>{404===e.request.status&&pjax.loadUrl("/404.html")})</script></div></body></html>